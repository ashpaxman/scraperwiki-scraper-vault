import scraperwiki
import json
import urllib
# Blank Python

base_url = "http://www.zap.com.br/imoveis/fipe-zap/ajax.aspx?"
args = {}
args['metodo'] = "obterdadosgraficoindicezapimoveis"
args['tipo'] = "apartamento"
args['transacao'] = "aluguel"
args['estado'] = "sao%20paulo"
args['cidade'] = "sao%20paulo"
args['bairro'] = 'se'
args['periodo'] = "todoperiodo"
args['qtddormitorios'] = '0' #0 para todos ; max 4+

opcoes = {}
opcoes['bairros'] = ["jd sta efigenia" , "a e carvalho" , "aclimacao" , "aeroporto" , "agua branca" , "agua fria" , "agua funda" , "agua rasa" , "alto boa vista" , "alto da lapa" , "alto da mooca" , "alto de pinheiros" , "alto de santana" , "alto do ipiranga" , "alto pari" , "americanopolis" , "analia franco" , "anhangabau" , "anhanguera" , "aricanduva" , "artur alvim" , "av paulista" , "b do jusa" , "balneario mar paulista" , "balneario sao jose" , "barra funda" , "barro branco" , "barro pre" , "bela vista" , "belem" , "belenzinho" , "berrini" , "boacava" , "bom retiro" , "bortolandia" , "bosque da saude" , "bras" , "brasilandia" , "bresser" , "brooklin" , "brooklin novo" , "brooklin pta" , "burgo paulista" , "butanta" , "cachoeirinha" , "cajamar" , "cambuci" , "campo belo" , "campo grande" , "campo limpo" , "campos eliseos" , "cangaiba" , "caninde" , "cantareira" , "capao redondo" , "capela socorro" , "carandiru" , "casa verde" , "casa verde alta" , "catumbi" , "caxingui" , "centro" , "cerq cesar" , "ch belenzinho" , "ch california" , "ch flora" , "ch gaivotas" , "ch inglesa" , "ch klabin" , "ch meyer" , "ch monte alegre" , "ch pouso alegre" , "ch santana" , "ch sto antonio" , "chora menino" , "cid ademar" , "cid d abril" , "cid dutra" , "cid ipava" , "cid jardim" , "cid julia" , "cid lider" , "cid moncoes" , "cid patriarca" , "cid sao francisco" , "cid tiradentes" , "cid universitaria" , "cid vargas" , "cipo do meio" , "city america" , "city boacava" , "city butanta" , "city lapa" , "city pinheiros" , "colonia (zona sul)" , "conceicao" , "conj hab faria lima" , "consolacao" , "cupece" , "cursino" , "eldorado" , "eng goulart" , "erm matarazzo" , "faria lima" , "ferreira" , "freguesia do o" , "grajau" , "granja julieta" , "guaianazes" , "guapira" , "guarapiranga" , "guavirutuba" , "heliopolis" , "higienopolis" , "hipodromo" , "horto do ipe" , "horto florestal" , "ibirapuera" , "imirim" , "indeterminado" , "indianopolis" , "instituto da previdencia" , "interlagos" , "ipiranga" , "itaberaba" , "itaim" , "itaim bibi" , "itaim pta" , "itaquera" , "jabaquara" , "jacana" , "jaguare" , "jaragua" , "jardim brasilia" , "jardim das vertentes" , "jardim germania" , "jardim mirante" , "jardim olimpia" , "jardim sabia" , "jardins" , "jd adalgiza" , "jd aeroporto" , "jd alfredo" , "jd alpino" , "jd amalia" , "jd america" , "jd ana lucia" , "jd andarai" , "jd angela" , "jd antartica" , "jd aricanduva" , "jd arpoador" , "jd aurora" , "jd avelino" , "jd avenida" , "jd bandeirantes" , "jd bandeiras" , "jd belgica" , "jd boa vista" , "jd bonfiglioli" , "jd borba gato" , "jd botucatu" , "jd brasil" , "jd brasilia" , "jd bussocaba city" , "jd cachoeira" , "jd california" , "jd camelias" , "jd campinas" , "jd casa grande" , "jd castro alves" , "jd celeste" , "jd climax" , "jd clipper" , "jd colonial" , "jd comercial" , "jd consorcio" , "jd cordeiro" , "jd cupece" , "jd d abril" , "jd da gloria" , "jd dabril" , "jd damasceno" , "jd danfer" , "jd das acacias" , "jd das flores" , "jd das imbuias" , "jd das palmas" , "jd das rosas" , "jd do carmo" , "jd do lago" , "jd dos bichinhos" , "jd dos prados" , "jd eliana" , "jd entre serras" , "jd ernestina" , "jd esmeralda" , "jd ester" , "jd europa" , "jd everest" , "jd figueira grande" , "jd floresta" , "jd florida paulista" , "jd franca" , "jd grimaldi" , "jd guanabara" , "jd guanca" , "jd guanhembu" , "jd guapira" , "jd guarani" , "jd guaruja" , "jd guedala" , "jd gustavo" , "jd helena" , "jd herculano" , "jd hipico" , "jd humaita" , "jd iguatemi" , "jd imperador" , "jd independencia" , "jd internacional" , "jd ipanema" , "jd ipe" , "jd iracema" , "jd iris" , "jd itamarati" , "jd itapeva" , "jd itapolis" , "jd iv centenario" , "jd ivete" , "jd jabaquara" , "jd jabaquara" , "jd jacana" , "jd japao" , "jd jaragua" , "jd joamar" , "jd joanopolis" , "jd joao xxiii" , "jd jussara" , "jd kherlakian" , "jd kioto" , "jd lallo" , "jd leonor" , "jd londrina" , "jd luanda" , "jd luzitania" , "jd macedonia" , "jd madalena" , "jd maraba" , "jd marajoara" , "jd marcel" , "jd maria estela" , "jd maria virginia" , "jd maringa" , "jd maristela" , "jd marquesa" , "jd matarazzo" , "jd melo" , "jd miriam" , "jd mont kemel" , "jd monte azul" , "jd morro verde" , "jd morumbi" , "jd mte alegre" , "jd mte belo" , "jd n sra do carmo" , "jd norma" , "jd nosso lar" , "jd nova jau" , "jd nove de julho" , "jd novo mundo" , "jd novo santo amaro" , "jd odete" , "jd ofelia" , "jd oliveira" , "jd oliveiras" , "jd oriental" , "jd oriente" , "jd palmares" , "jd panorama" , "jd paraiso" , "jd paris" , "jd patente" , "jd patente novo" , "jd paula" , "jd paulista" , "jd paulistano" , "jd penha" , "jd peri" , "jd peri peri" , "jd perola iii" , "jd petropolis" , "jd piaui" , "jd pinheiros" , "jd piqueroby" , "jd pirajussara" , "jd piratininga" , "jd pirituba" , "jd planalto" , "jd platina" , "jd popular" , "jd presidente" , "jd previdencia" , "jd primavera" , "jd progresso" , "jd promissao" , "jd prudencia" , "jd rap tavares" , "jd real" , "jd reboucas" , "jd recanto" , "jd recanto verde" , "jd regis" , "jd represa" , "jd riviera" , "jd rizzo" , "jd rosa maria" , "jd s bento" , "jd s joao" , "jd s jorge" , "jd s judas" , "jd s luis" , "jd s luiz" , "jd s nicolau" , "jd s paulo" , "jd s pedro" , "jd s rafael" , "jd s saverio" , "jd sabara" , "jd sandra" , "jd santa helena" , "jd sao carlos" , "jd satelite" , "jd saude" , "jd seckler" , "jd shangrila" , "jd silva teles" , "jd silveira" , "jd silvia" , "jd sonia marly" , "jd sta clara" , "jd sta cruz" , "jd sta edwiges" , "jd sta emilia" , "jd sta ines" , "jd sta maria" , "jd sta monica" , "jd sta rita" , "jd sta teresinha" , "jd sto amaro" , "jd sto elias" , "jd sul" , "jd suzano" , "jd taboao" , "jd textil" , "jd thomaz" , "jd tiete" , "jd tres marias" , "jd tupi" , "jd ubirajara (zona sul)" , "jd umarizal" , "jd umuarama" , "jd universidade" , "jd varginha" , "jd vera cruz" , "jd vergueiro" , "jd vilas boas" , "jd virginia" , "jd virginia bianca" , "jd vitoria regia" , "jd vl formosa" , "jd vl mariana" , "jdgilda maria" , "jordanopolis" , "jurubatuba" , "jardim olimpia" , "jd maraba" , "jd sta teresinha" , "klabin" , "lageado" , "lapa" , "lapa de baixo" , "lar nacional" , "lar sao paulo" , "lausane" , "lauzane paulista" , "liberdade" , "limao" , "limoeiro" , "luz" , "mandaqui" , "maranhao" , "mercado" , "mirandopolis" , "moema" , "moinho velho" , "mooca" , "morada do sol" , "morro do indio" , "morro doce" , "morro dos ingleses" , "morro ingleses" , "morumbi" , "mutinga" , "nova piraju" , "novo horizonte" , "pacaembu" , "paineiras do morumbi" , "paissandu" , "palmas do tremembe" , "panamby" , "parada de taipas" , "parada inglesa" , "parada quinze" , "paraiso" , "paraisopolis" , "parelheiros" , "pari" , "pauliceia" , "pca bandeira" , "pca da arvore" , "pedra branca" , "pedreira" , "penha" , "perdizes" , "perus" , "pinheiros" , "piqueri" , "piraju" , "pirajussara" , "piraporinha" , "pirituba" , "planalto paulista" , "polvilho" , "pompeia" , "portal do morumbi" , "pq  s jorge" , "pq alves de lima" , "pq america" , "pq anhanguera" , "pq anhembi" , "pq atlantico" , "pq b esperanca" , "pq boturussu" , "pq brasil" , "pq bristol" , "pq casa de pedras" , "pq central" , "pq cocaia" , "pq conceicao" , "pq continental" , "pq cruzeiro sul" , "pq d pedro ii" , "pq das arvores" , "pq das flores" , "pq das nacoes" , "pq do carmo" , "pq do engenho" , "pq do lago" , "pq do terceiro lago" , "pq doroteia" , "pq dos principes" , "pq edu chaves" , "pq esmeralda" , "pq fernanda" , "pq fongaro" , "pq grajau" , "pq ibirapuera" , "pq imperial" , "pq ipe" , "pq jabaquara" , "pq lapa" , "pq mandaqui" , "pq maria domitila" , "pq maria helena" , "pq maria luisa" , "pq mooca" , "pq morumbi" , "pq nv mundo" , "pq peruche" , "pq primavera" , "pq s domingos" , "pq s jorge" , "pq s lucas" , "pq s luis" , "pq s paulo" , "pq sao luis" , "pq savoy" , "pq slourenco" , "pq tiete" , "pq vitoria" , "praia da lagoa" , "praias paulistanas" , "pte pequena" , "pte rasa" , "quinta da paineira" , "ramos freitas" , "real parque" , "recanto campo belo" , "republica" , "rio bonito" , "rio pequeno" , "riviera paulista" , "rolinopolis" , "s joao climaco" , "s judas" , "s mateus" , "s miguel pta" , "sacoma" , "santana" , "sapopemba" , "saude" , "se" , "serra da cantareira" , "sete praias" , "socorro" , "st pinheirinho" , "sta cecilia" , "sta cruz" , "sta efigenia" , "sta etelvina" , "sta terezinha" , "sto amaro" , "sto amaro veleiros" , "sumare" , "sumarezinho" , "tatuape" , "tremembe" , "tucuruvi" , "v  loty" , "v conde do pinhal" , "v madalena" , "v marina" , "veleiros" , "vila andradas" , "vila aricanduva" , "vila buenos aires" , "vila castelo" , "vila congonhas" , "vila missionaria" , "vila roque" , "vila rosaria" , "vila santana" , "vila sao jose" , "vila sofia" , "vista alegre" , "vl agua funda" , "vl albertina" , "vl alexandria" , "vl alpina" , "vl alvorada" , "vl amalia" , "vl analia" , "vl anastacio" , "vl andrade" , "vl anglo" , "vl antonieta" , "vl antonina" , "vl arapua" , "vl arriete" , "vl aurora" , "vl aurora   norte" , "vl aurora   oeste" , "vl bancaria" , "vl beatriz" , "vl bela" , "vl bertioga" , "vl bonilha" , "vl brasilandia" , "vl brasilina" , "vl brasilio machado" , "vl buarque" , "vl brasilina" , "vl cachoeira" , "vl california" , "vl campestre" , "vl canero" , "vl carbone" , "vl carioca" , "vl carmosina" , "vl carrao" , "vl celeste" , "vl cisper" , "vl clarice" , "vl clementino" , "vl constanca" , "vl constancia" , "vl cruzeiro" , "vl cruzeiro sul" , "vl curuca" , "vl d pedro i" , "vl d pedro ii" , "vl dalila" , "vl dalva" , "vl damaceno" , "vl das belezas" , "vl das merces" , "vl dionisia" , "vl diva" , "vl do encontro" , "vl domitilia" , "vl dos andrades" , "vl dos remedios" , "vl ede" , "vl ema" , "vl esmeralda" , "vl espanhola" , "vl esperanca" , "vl ester" , "vl euthalia" , "vl fachini" , "vl fernandes" , "vl fiat lux" , "vl fidalgo" , "vl filomena" , "vl formosa" , "vl franc mendes" , "vl franca" , "vl franci" , "vl friburgo" , "vl gea" , "vl germaine" , "vl gertrudes" , "vl gomes" , "vl gomes cardim" , "vl guaianazes" , "vl guarani" , "vl guaruja" , "vl guilherme" , "vl guilhermina" , "vl gumercindo" , "vl gustavo" , "vl haddad" , "vl hamburguesa" , "vl heliopolis" , "vl iara" , "vl ida" , "vl im conceicao" , "vl inah" , "vl independencia" , "vl industrial" , "vl inglesa" , "vl invernada" , "vl iorio" , "vl ipojuca" , "vl irmaos arnoni" , "vl isa" , "vl itaim" , "vl ivone" , "vl jacui" , "vl jaguara" , "vl jaguare" , "vl jaguari" , "vl jaragua" , "vl joaniza" , "vl lageado" , "vl leme" , "vl leopoldina" , "vl libanesa" , "vl lisboa" , "vl liviero" , "vl lobos" , "vl londrina" , "vl madalena" , "vl mangalot" , "vl maracana" , "vl marari" , "vl maria" , "vl maria alta" , "vl mariana" , "vl marieta" , "vl mariliza" , "vl marina" , "vl mariza mazzei" , "vl mascote" , "vl matias" , "vl matilde" , "vl mazzei" , "vl medeiros" , "vl mendes" , "vl mercedes" , "vl mirante" , "vl moinho velho" , "vl monte alegre" , "vl monte verde" , "vl monumento" , "vl moraes" , "vl morro grande" , "vl morumbi" , "vl munhoz" , "vl n conceicao" , "vl n s conceicao" , "vl n s do retiro" , "vl nair" , "vl natalia" , "vl nhocune" , "vl nilo" , "vl nivi" , "vl noca" , "vl nova" , "vl nova savoia" , "vl nova york" , "vl nv cachoeirinha" , "vl nv caledonia" , "vl nv galvao" , "vl nv jaguara" , "vl nv manchester" , "vl nv mazzei" , "vl nv parada" , "vl olimpia" , "vl oratorio" , "vl orlando" , "vl paiva" , "vl palmeiras" , "vl paranagua" , "vl pauliceia" , "vl paulina" , "vl paulista" , "vl paulistana" , "vl paulo silas" , "vl pedroso" , "vl penteado" , "vl perus" , "vl piaui" , "vl piracicaba" , "vl pirajussara" , "vl pires" , "vl pirituba" , "vl pompeia" , "vl portuguesa" , "vl pq jabaquara" , "vl prel" , "vl previdencia" , "vl primavera" , "vl progredior" , "vl progresso" , "vl prsa isabel" , "vl prudente" , "vl pte rasa" , "vl ramos" , "vl re" , "vl regente feijo" , "vl remo" , "vl ribeiro de barros" , "vl rica" , "vl rio branco" , "vl rio pequeno" , "vl robertina" , "vl romana" , "vl roseira" , "vl rui barbosa" , "vl ruth" , "vl s domingos" , "vl s francisco" , "vl s francisco   leste" , "vl s jose" , "vl sabara" , "vl sabrina" , "vl salete" , "vl sao paulo" , "vl silvia" , "vl socorro" , "vl sonia" , "vl souza" , "vl sta catarina" , "vl sta clara" , "vl sta cruz" , "vl sta eulalia" , "vl sta isabel" , "vl sta luzia" , "vl sta maria" , "vl sta tereza" , "vl sta terezinha" , "vl sta virginia" , "vl sto estefan" , "vl suzana" , "vl talarico" , "vl taquari" , "vl terezinha" , "vl tiradentes" , "vl tramontano" , "vl universitaria" , "vl vera" , "vl verde" , "vl vergueiro" , "vl virginia" , "vl zati" , "vl zelina" , "vl zilda" , "vila aricanduva"]

opcoes['bairros'] = []
opcoes['dormitorios'] = ['1', '2', '3','4']

def args_to_string(args):
    string_args = ''
    for item in args:
        string_args = string_args + '&' + item + '=' + args[item]
    return string_args

current_args = args

for b in opcoes['bairros']:
    for d in opcoes['dormitorios']:
        current_args['bairro'] = b
        current_args['qtddormitorios'] = d
        url = base_url + args_to_string(args)
        json_file = urllib.urlopen(url).read()
        jason = json.loads(json_file)
        for entry in jason:
            entry['dormitorios'] = d
            entry['bairro'] = b
            entry['id'] = str(entry['Ano']) + '-' + str(entry['Mes']) + '-' + entry['dormitorios'] + '-' + entry['bairro']
            scraperwiki.sqlite.save(['id'], entry)


