import scraperwiki
import csv
from cStringIO import StringIO

# Data from http://appsso.eurostat.ec.europa.eu/nui/show.do?dataset=lfsi_emp_a&lang=en
# Couldn't download it because it requires Ajax etc so I've dumped the csv
csv_data = """"GEO/TIME","1998","1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009"
"European Union (EU6-1972, EU9-1980, EU10-1985, EU12-1994, EU15-2004, EU25-2006, EU27)",154064.2,157278.6,159695.0,162036.7,163148.9,164806.0,166256.1,198697.7,202517.3,219054.9,221670.3,217826.9
"European Union (27 countries)",198166.7,200855.7,202540.1,204488.6,204335.0,205604.5,207311.3,210794.2,214918.5,219054.9,221670.3,217826.9
"European Union (25 countries)",184514.2,187324.1,189092.6,191182.9,192003.0,193614.8,195285.5,198697.7,202517.3,206449.0,208940.5,205329.8
"European Union (15 countries)",154064.2,157278.6,159695.0,162036.7,163148.9,164806.0,166256.1,169140.6,172160.9,175175.7,176984.6,173860.6
"Zone euro (EA11-2000, EA12-2006, EA13-2007, EA15-2008, EA16)",116107.4,118807.8,121287.3,127355.6,128293.0,129711.1,130858.4,133375.1,135994.8,139698.5,141713.2,141552.9
"Euro area (16 countries)",123622.8,126273.3,128817.2,130848.7,131790.6,133246.5,134457.1,137036.1,139767.2,142590.5,144147.0,141552.9
"Euro area (15 countries)",121424.4,124141.3,126715.5,128727.6,129667.4,131084.8,132289.3,134820.9,137465.0,140232.8,141713.2,139186.5
"Euro area (13 countries)",121020.8,123722.0,126276.4,128271.9,129202.6,130608.4,131801.9,134324.3,136956.0,139698.5,141170.1,138643.2
"Euro area (12 countries)",120125.3,122839.2,125375.8,127355.6,128293.0,129711.1,130858.4,133375.1,135994.8,138713.3,140174.0,137662.6
"Euro area (11 countries)",116107.4,118807.8,121287.3,123269.3,124117.3,125436.6,126545.3,129006.2,131542.5,134203.5,135614.6,133153.9
"Belgium",3864.9,4007.0,4092.7,4055.6,4069.8,4070.4,4138.9,4235.4,4264.0,4380.3,4445.9,4420.7
"Bulgaria",":",":",2794.7,2702.8,2741.0,2834.7,2922.6,2981.9,3110.0,3252.6,3360.7,3253.6
"Czech Republic",4822.1,4714.2,4681.3,4684.1,4731.1,4701.1,4690.5,4764.0,4828.1,4922.0,5002.5,4934.3
"Denmark",2673.8,2699.7,2713.2,2737.3,2723.5,2707.4,2738.2,2752.4,2805.4,2803.8,2853.8,2776.0
"Germany (including  former GDR from 1991)",35625.6,36281.4,36466.4,36572.9,36289.3,35924.9,35841.0,36653.8,37379.3,38209.5,38879.7,38796.7
"Estonia",606.3,580.6,572.5,577.7,585.5,594.3,595.5,607.4,646.3,655.3,656.5,595.8
"Ireland",1522.5,1617.3,1692.2,1745.4,1777.0,1810.6,1864.9,1952.0,2043.7,2116.5,2101.2,1917.0
"Greece",4017.9,4031.4,4088.5,4086.3,4175.8,4274.5,4313.2,4368.9,4452.3,4509.8,4559.4,4508.7
"Spain",13904.2,14689.8,15505.9,16146.3,16630.3,17295.9,17970.8,18973.2,19747.7,20356.0,20257.6,18888.0
"France",22345.3,22738.2,23331.2,23755.6,23943.6,24695.9,24799.7,24976.6,25132.2,25563.8,25911.8,25704.4
"Italy",20435.2,20691.6,21079.8,21514.4,21829.3,22054.2,22404.4,22562.8,22988.2,23221.8,23404.7,23025.0
"Cyprus",":",":",295.7,309.6,317.2,328.6,339.5,348.0,357.3,377.9,382.9,381.3
"Latvia",987.4,970.5,943.7,959.3,986.3,1006.9,1018.0,1033.7,1087.1,1118.0,1124.5,983.1
"Lithuania",1488.6,1465.5,1404.0,1357.5,1401.0,1432.6,1432.6,1473.9,1499.0,1534.2,1520.0,1415.9
"Luxembourg",171.5,176.7,181.4,185.6,188.0,187.1,188.4,193.6,195.3,202.9,202.4,217.2
"Hungary",3670.6,3791.5,3829.1,3868.3,3870.6,3921.9,3900.4,3901.5,3930.0,3926.2,3879.4,3781.8
"Malta",":",":",143.4,146.1,147.6,147.8,147.9,148.5,151.7,156.3,160.3,162.1
"Netherlands",7512.5,7702.1,7870.2,8068.7,8168.0,8121.4,8105.8,8110.9,8260.9,8463.5,8592.7,8596.1
"Austria",3655.0,3696.2,3710.5,3746.1,3712.4,3793.4,3743.9,3824.4,3928.2,4027.8,4089.9,4077.5
"Poland",15377.5,15088.9,14525.7,14206.2,13781.9,13616.8,13793.9,14115.6,14593.6,15240.5,15799.8,15868.0
"Portugal",4843.5,4910.0,5020.7,5111.7,5137.3,5118.0,5122.8,5122.6,5159.5,5169.7,5197.8,5054.1
"Romania",10769.7,10648.8,10652.8,10603.0,9590.9,9154.9,9103.2,9114.6,9291.2,9353.3,9369.1,9243.5
"Slovenia",895.5,882.8,900.7,916.3,909.6,897.2,943.4,949.2,961.2,985.2,996.1,980.7
"Slovakia",2198.5,2132.0,2101.6,2121.1,2123.3,2161.7,2167.8,2215.2,2302.3,2357.7,2433.7,2366.3
"Finland",2227.1,2297.5,2336.3,2367.0,2372.3,2364.9,2364.6,2400.8,2443.5,2491.6,2530.9,2457.3
"Sweden",4059.1,4148.8,4240.3,4318.1,4323.9,4314.4,4290.0,4346.7,4429.4,4540.7,4593.0,4499.3
"United Kingdom",27206.1,27590.9,27365.7,27625.7,27808.4,28073.0,28369.4,28666.4,28931.3,29117.8,29363.9,28922.7
"Iceland",":",":",":",":",":",155.0,154.9,159.9,167.8,175.5,177.1,166.2
"Norway",":",":",2255.0,2265.3,2275.5,2257.6,2266.5,2282.6,2353.0,2434.2,2513.7,2499.5
"Switzerland",3833.0,3862.0,3878.8,3938.2,3964.9,3963.0,3959.2,3974.5,4051.4,4122.0,4228.8,4280.1
"Croatia",":",":",":",":",1527.1,1536.3,1562.7,1572.9,1586.3,1614.4,1635.5,1605.3
"Ancienne République yougoslave de Macédoine",":",":",":",":",":",":",":",":",570.5,590.2,609.0,629.9
"Turkey",":",":",":",":",":",":",":",":",20433.2,20749.8,21193.0,21270.7
"""

for i, row in enumerate(csv.reader(StringIO(csv_data))):
    if i == 0:
        continue
    scraperwiki.sqlite.save(['country'], {'country': row[0],
                                              '1998': '' if row[1] == ':' else float(row[1]) * 1000,
                                              '1999': '' if row[2] == ':' else float(row[2]) * 1000,
                                              '2000': '' if row[3] == ':' else float(row[3]) * 1000,
                                              '2001': '' if row[4] == ':' else float(row[4]) * 1000,
                                              '2002': '' if row[5] == ':' else float(row[5]) * 1000,
                                              '2003': '' if row[6] == ':' else float(row[6]) * 1000,
                                              '2004': '' if row[7] == ':' else float(row[7]) * 1000,
                                              '2005': '' if row[8] == ':' else float(row[8]) * 1000,
                                              '2006': '' if row[9] == ':' else float(row[9]) * 1000,
                                              '2007': '' if row[10] == ':' else float(row[10]) * 1000,
                                              '2008': '' if row[11] == ':' else float(row[11]) * 1000,
                                              '2009': '' if row[12] == ':' else float(row[12]) * 1000, 
                                            })
import scraperwiki
import csv
from cStringIO import StringIO

# Data from http://appsso.eurostat.ec.europa.eu/nui/show.do?dataset=lfsi_emp_a&lang=en
# Couldn't download it because it requires Ajax etc so I've dumped the csv
csv_data = """"GEO/TIME","1998","1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009"
"European Union (EU6-1972, EU9-1980, EU10-1985, EU12-1994, EU15-2004, EU25-2006, EU27)",154064.2,157278.6,159695.0,162036.7,163148.9,164806.0,166256.1,198697.7,202517.3,219054.9,221670.3,217826.9
"European Union (27 countries)",198166.7,200855.7,202540.1,204488.6,204335.0,205604.5,207311.3,210794.2,214918.5,219054.9,221670.3,217826.9
"European Union (25 countries)",184514.2,187324.1,189092.6,191182.9,192003.0,193614.8,195285.5,198697.7,202517.3,206449.0,208940.5,205329.8
"European Union (15 countries)",154064.2,157278.6,159695.0,162036.7,163148.9,164806.0,166256.1,169140.6,172160.9,175175.7,176984.6,173860.6
"Zone euro (EA11-2000, EA12-2006, EA13-2007, EA15-2008, EA16)",116107.4,118807.8,121287.3,127355.6,128293.0,129711.1,130858.4,133375.1,135994.8,139698.5,141713.2,141552.9
"Euro area (16 countries)",123622.8,126273.3,128817.2,130848.7,131790.6,133246.5,134457.1,137036.1,139767.2,142590.5,144147.0,141552.9
"Euro area (15 countries)",121424.4,124141.3,126715.5,128727.6,129667.4,131084.8,132289.3,134820.9,137465.0,140232.8,141713.2,139186.5
"Euro area (13 countries)",121020.8,123722.0,126276.4,128271.9,129202.6,130608.4,131801.9,134324.3,136956.0,139698.5,141170.1,138643.2
"Euro area (12 countries)",120125.3,122839.2,125375.8,127355.6,128293.0,129711.1,130858.4,133375.1,135994.8,138713.3,140174.0,137662.6
"Euro area (11 countries)",116107.4,118807.8,121287.3,123269.3,124117.3,125436.6,126545.3,129006.2,131542.5,134203.5,135614.6,133153.9
"Belgium",3864.9,4007.0,4092.7,4055.6,4069.8,4070.4,4138.9,4235.4,4264.0,4380.3,4445.9,4420.7
"Bulgaria",":",":",2794.7,2702.8,2741.0,2834.7,2922.6,2981.9,3110.0,3252.6,3360.7,3253.6
"Czech Republic",4822.1,4714.2,4681.3,4684.1,4731.1,4701.1,4690.5,4764.0,4828.1,4922.0,5002.5,4934.3
"Denmark",2673.8,2699.7,2713.2,2737.3,2723.5,2707.4,2738.2,2752.4,2805.4,2803.8,2853.8,2776.0
"Germany (including  former GDR from 1991)",35625.6,36281.4,36466.4,36572.9,36289.3,35924.9,35841.0,36653.8,37379.3,38209.5,38879.7,38796.7
"Estonia",606.3,580.6,572.5,577.7,585.5,594.3,595.5,607.4,646.3,655.3,656.5,595.8
"Ireland",1522.5,1617.3,1692.2,1745.4,1777.0,1810.6,1864.9,1952.0,2043.7,2116.5,2101.2,1917.0
"Greece",4017.9,4031.4,4088.5,4086.3,4175.8,4274.5,4313.2,4368.9,4452.3,4509.8,4559.4,4508.7
"Spain",13904.2,14689.8,15505.9,16146.3,16630.3,17295.9,17970.8,18973.2,19747.7,20356.0,20257.6,18888.0
"France",22345.3,22738.2,23331.2,23755.6,23943.6,24695.9,24799.7,24976.6,25132.2,25563.8,25911.8,25704.4
"Italy",20435.2,20691.6,21079.8,21514.4,21829.3,22054.2,22404.4,22562.8,22988.2,23221.8,23404.7,23025.0
"Cyprus",":",":",295.7,309.6,317.2,328.6,339.5,348.0,357.3,377.9,382.9,381.3
"Latvia",987.4,970.5,943.7,959.3,986.3,1006.9,1018.0,1033.7,1087.1,1118.0,1124.5,983.1
"Lithuania",1488.6,1465.5,1404.0,1357.5,1401.0,1432.6,1432.6,1473.9,1499.0,1534.2,1520.0,1415.9
"Luxembourg",171.5,176.7,181.4,185.6,188.0,187.1,188.4,193.6,195.3,202.9,202.4,217.2
"Hungary",3670.6,3791.5,3829.1,3868.3,3870.6,3921.9,3900.4,3901.5,3930.0,3926.2,3879.4,3781.8
"Malta",":",":",143.4,146.1,147.6,147.8,147.9,148.5,151.7,156.3,160.3,162.1
"Netherlands",7512.5,7702.1,7870.2,8068.7,8168.0,8121.4,8105.8,8110.9,8260.9,8463.5,8592.7,8596.1
"Austria",3655.0,3696.2,3710.5,3746.1,3712.4,3793.4,3743.9,3824.4,3928.2,4027.8,4089.9,4077.5
"Poland",15377.5,15088.9,14525.7,14206.2,13781.9,13616.8,13793.9,14115.6,14593.6,15240.5,15799.8,15868.0
"Portugal",4843.5,4910.0,5020.7,5111.7,5137.3,5118.0,5122.8,5122.6,5159.5,5169.7,5197.8,5054.1
"Romania",10769.7,10648.8,10652.8,10603.0,9590.9,9154.9,9103.2,9114.6,9291.2,9353.3,9369.1,9243.5
"Slovenia",895.5,882.8,900.7,916.3,909.6,897.2,943.4,949.2,961.2,985.2,996.1,980.7
"Slovakia",2198.5,2132.0,2101.6,2121.1,2123.3,2161.7,2167.8,2215.2,2302.3,2357.7,2433.7,2366.3
"Finland",2227.1,2297.5,2336.3,2367.0,2372.3,2364.9,2364.6,2400.8,2443.5,2491.6,2530.9,2457.3
"Sweden",4059.1,4148.8,4240.3,4318.1,4323.9,4314.4,4290.0,4346.7,4429.4,4540.7,4593.0,4499.3
"United Kingdom",27206.1,27590.9,27365.7,27625.7,27808.4,28073.0,28369.4,28666.4,28931.3,29117.8,29363.9,28922.7
"Iceland",":",":",":",":",":",155.0,154.9,159.9,167.8,175.5,177.1,166.2
"Norway",":",":",2255.0,2265.3,2275.5,2257.6,2266.5,2282.6,2353.0,2434.2,2513.7,2499.5
"Switzerland",3833.0,3862.0,3878.8,3938.2,3964.9,3963.0,3959.2,3974.5,4051.4,4122.0,4228.8,4280.1
"Croatia",":",":",":",":",1527.1,1536.3,1562.7,1572.9,1586.3,1614.4,1635.5,1605.3
"Ancienne République yougoslave de Macédoine",":",":",":",":",":",":",":",":",570.5,590.2,609.0,629.9
"Turkey",":",":",":",":",":",":",":",":",20433.2,20749.8,21193.0,21270.7
"""

for i, row in enumerate(csv.reader(StringIO(csv_data))):
    if i == 0:
        continue
    scraperwiki.sqlite.save(['country'], {'country': row[0],
                                              '1998': '' if row[1] == ':' else float(row[1]) * 1000,
                                              '1999': '' if row[2] == ':' else float(row[2]) * 1000,
                                              '2000': '' if row[3] == ':' else float(row[3]) * 1000,
                                              '2001': '' if row[4] == ':' else float(row[4]) * 1000,
                                              '2002': '' if row[5] == ':' else float(row[5]) * 1000,
                                              '2003': '' if row[6] == ':' else float(row[6]) * 1000,
                                              '2004': '' if row[7] == ':' else float(row[7]) * 1000,
                                              '2005': '' if row[8] == ':' else float(row[8]) * 1000,
                                              '2006': '' if row[9] == ':' else float(row[9]) * 1000,
                                              '2007': '' if row[10] == ':' else float(row[10]) * 1000,
                                              '2008': '' if row[11] == ':' else float(row[11]) * 1000,
                                              '2009': '' if row[12] == ':' else float(row[12]) * 1000, 
                                            })
