import scraperwiki
import simplejson
import urllib2
import sys

SCREENNAME = 'mikapirhonen' #  - just for reminding, no actual use
c = 0
n = 0
#{'reset_time': 'Thu Apr 05 22:13:14 +0000 2012', 'remaining_hits': 0, 'hourly_limit': 150, 'reset_time_in_seconds': 1333663994}
resetrate_url = 'https://api.twitter.com/1/account/rate_limit_status.json'
resetrate_json = simplejson.loads(scraperwiki.scrape(resetrate_url))
print resetrate_json
print 'You have %s hits left of 150. Reload time is at - %s -' % (resetrate_json['remaining_hits'], resetrate_json['reset_time']) 

#PUT HERE a list of follower's id
lista = [25065931,131575586,425662368,221501401,48277956,15487001,163480463,20932375,37483735,19342892,21243219,363055355,326765877,84652506,537222739,532892366,27621959,281487951,168597350,21026596,122384941,81633482,18599476,420516748,224943395,25066495,49330305,524732380,408730137,426442687,23739307,79843502,139974630,120802940,423426629,133185594,493208206,461201574,113762357,263811916,441617223,70636551,180742547,435857424,289767245,496338193,486743563,16986635,184743515,516316452,113348784,157241090,182549347,376112744,45317597,240207367,120760003,456124705,218443293,124139637,421382180,29689455,29426045,107508796,424564514,330237340,144318792,281954561,19120153,388740093,60562610,59076504,259654794,481981578,173115724,26040028,390854986,276618851,336111790,496998068,86523664,398659891,218105502,308329921,401527517,425686194,365495604,240150593,220933156,261359918,400660558,120207925,51748261,237416112,97161136,428575452,94123963,34611019,85568401,286255386,287056919,329503437,487798637,471377191,182565585,80074783,293667475,29803296,24140765,1424431,72925064,27417458,325032908,482814731,110604718,379853627,315221301,58663928,7928622,405807314,15351845,58435819,97257153,47237865,30625540,96594983,208484103,28311607,260874209,23744470,423354428,484115525,43360175,18607750,293535414,192423199,37959657,431702899,331132813,19337766,25268744,110759549,421226464,472810111,154047671,176430467,420022758,467368925,267072171,427286515,459054224,287256859,75255662,394208419,97670081,408743967,347423381,453784237,31103526,247277350,22629024,465398448,325058309,17243913,474360877,463608539,68227505,435773068,426469307,209073357,403342277,33844169,26830676,425843876,114723763,138526129,30931835,198826114,18606767,368199853,396811941,188627191,75234234,19308529,64203453,15521350,252547221,114690195,38816542,24964422,28077489,317080762,407812095,407304219,357076509,65971046,467376419,18533828,408271246,276911574,93936160,446602113,455561279,159958848,49013625,22737511,425661002,425657741,350300539,45548817,17564168,462286167,456358111,321231837,339542222,64830462,41651717,110493104,430016780,407959551,20324973,423488493,218836548,55960182,85537158,258409768,29657011,52447702,88876150,363637875,267760307,340258228,41330145,350015005,412579026,54954594,167778423,449026442,426550264,68410168,26292218,436214107,16706344,440979078,261180763,431078930,157749525,158716395,91318134,453682179,10029732,311681011,47342599,325968661,252729237,376327472,228668350,399564723,17939970,350463809,280898348,211841899,156895489,439460810,447672298,273221987,329931629,20624036,18212957,423474106,248307923,22470277,243278144,295739079,157928648,30482231,197119145,440742217,148500864,432414670,216282763,284730339,362310309,440993589,440870916,176384260,59136010,303631084,146584055,47276003,439384594,132432232,114190724,82563845,40219683,152161092,49589863,302509288,200428611,121997851,436969356,130305298,31673599,298347334,14755988,420570111,430980922,285492043,374034494,430224820,62261202,428091343,352750214,41332997,429792190,224671891,224250614,432362570,128404685,424244751,434241693,223941213,26732407,407611967,18472399,157000503,305219173,423695516,323261080,262771060,6602952,20761934,374430433,198445040,18132670,258462627,21187644,417246923,23480205,317457842,216448822,38429072,39259963,317618006,287801111,28757338,15775978,36353978,74975464,83398258,223409880,17963191,141682676,21550734,271097408,131944579,146658224,412240008,104818833,224622999,46905923,18132451,92938502,101457482,44945145,118981106,416497051,397835956,336083411,139496374,288153222,110483876,108580489,57161847,232665310,240884208,276842487,371138243,29492570,112978241,350484026,22797686,92703365,418811972,53677389,31634823,418820131,55927258,59247745,55534033,41890489,109205108,194928965,284562212,300716312,107159745,413330288,271845217,274094762,18393491,48084843,124339443,411502604,93862231,20624395,7555782,304804330,12323552,49304190,247303258,14656057,406820800,285876522,15114927,21194582,390016434,304415968,260836502,281986476,256589433,405202786,395873179,240819202,265028142,392711115,9585582,403901199,277556628,398783797,313598500,71880308,361790266,26102521,261791261,392711359,396485461,83568421,15468299,18881541,351464360,188436540,63666966,387855078,12323042,270466536,17948250,169421250,5863392,234478164,339429511,275065933,318821105,375752277,263058638,114684567,49057872,384224000,42069029,269805356,181638177,23745760,18932935,86270150,29629039,20507517,67266336,316404112,93829849,349513956,379044249,79584032,257014593,14367725,12550682,48336950,161650067,359851773,352339762,29527862,46331041,133235131,282421113,367180328,115180114,370029655,65590627,370269606,43335085,156951821,372031377,139014812,133407635,35427955,367963870,44361491,87162030,11503752,292838330,221333493,102984435,253714448,133698522,18266486,233836410,189056270,364749198,28768946,78859905,14801580,44632485,57635408,362465522,165006495,200004094,165843097,189498819,354780292,28754034,27904043,240216406,7200752,351856844,348337806,247850994,116869717,298621654,41762177,333949163,352210312,17211426,51697333,28536525,85784333,347833945,17994895,42852229,344257156,261699922,328830752,226981222,252988450,58598143,262815123,260628355,74382201,340969961,340682815,232989293,83842212,337041176,333216172,5874122,132456693,336401100,68111414,19678124,320687857,16110222,14273044,155290328,20107082,325480428,319472262,312565532,116427510,269350667,118876667,329314824,48942140,32376263,302513800,19830008,326126042,16219247,28973665,324692750,221799635,29994938,310980350,101528153,89661107,251169763,61425181,12441132,278036867,319325224,258038452,76654856,302160239,18999759,151644613,29685832,244953643,95379713,310396757,239696089,13740602,64225071,108630742,22764476,308611237,280885082,310336691,262449821,56956655,58568152,77836871,201587011,19905986,70333896,18157856,153859877,23479608,251021119,208432888,15776240,256872986,56800316,34878643,17438664,295601460,242214721,300190968,63527074,28968310,149149335,42640298,114144050,36471278,208167487,15747938,59798715,50961013,146081868,56477964,266001904,62200145,124246972,160527484,201175944,143528756,264154489,256499438,41204815,216148108,274920641,8830042,146618989,284478086,97285523,224417952,285796003,176824061,84145738,114531905,32486235,283842667,283676779,214008845,245324743,280629713,21695613,96437165,270225338,210071354,173503289,248599523,281396967,280658520,8854792,279637781,55581844,107393662,777433,27451431,49249180,105915412,126586209,14266117,256076224,95407870,21684736,24869761,125601252,16061163,266026288,273873883,50744958,28782464,24033118,113048301,214250993,47389708,273902407,207546384,58818905,270784975,19497039,27206892,77981676,137089400,245698005,34725256,142977623,17661968,174786223,21787960,266525586,264795893,17621290,264141147,212531741,81897817,81818413,35724163,251823002,112816059,257569346,15656722,156272364,239157425,125016954,36027831,248716346,223453582,265823952,222245765,114996185,79270210,20503912,26711501,53465673,44172458,227285416,147518127,158984672,259209836,139351136,208703269,17063694,130684475,252462399,15926718,55316171,220672968,81142302,260193354,15011150,25048631,230402128,88641905,14281841,255457505,233997129,20622234,8440552,107722679,258244525,251685465,96950187,71257829,255674243,239078877,97292706,251101506,62620735,218955487,95642758,40037823,183658275,24669835,226262155,20389631,245752699,94168183,146423720,102010466,194457742,87314364,149046357,27194845,31892367,45953109,245718132,252987375,23499199,153860955,609663,10512712,188714490,190650259,73867482,237662413,160899313,31922164,245449737,63170099,85605620,195645364,15580384,92360037,181111597,18717138,15179791,112198413,215686339,12016992,203574543,218807369,26817718,34339205,139733501,214919581,245074292,46180560,134116716,242648184,107750908,49992313,23479304,87886476,49609985,33598269,26189216,190584751,57932466,23466089,60835835,117376525,102025211,111950574,111976700,95559675,59057158,50395453,156907738,39207660,14461551,45343200,37734064,97255235,90406034,225878736,14157810,89398664,105103109,178163572,2754521,149475166,229396232,25261244,9312552,169970131,39210238,28006501,64988419,14301783,17801749,21733540,99491210,120065660,140103585,39975027,69821056,71341838,14076980,135809363,209459812,40204167,91543055,17337554,216867363,72648886,22362222,52525439,18768419,212155281,26847675,207183055,19232478,101700887,38617356,61590821,70483539,217850013,23483819,16964609,221424326,212302569,55025892,210825049,221423704,18363508,202602407,65617605,93207353,42942682,41644465,102425654,19447383,182747581,216305509,20937910,71515593,23488524,118703531,35711196,120545919,74120119,116706058,46196044,89434823,111372034,157243343,206272796,41999248,14087632,12641112,195047638,96761126,18632646,201375516,202985553,68914379,88745281,24147717,42361971,126293147,51188048,197088514,111448029,60038174,14662163,192530788,39480276,27857108,39251308,8980752,127752505,109962895,80518687,184026629,14384133,17761008,43112148,86263348,58802669,108313540,83789727,21486642,118793791,72814867,108701268,98834390,79969468,34243490,128968441,22471974,23116687,34356968,18485019,18676836,82826646,15687977,42240022,19651554,17866320,13419352,19412403,23981582,39559231,12063202,88468420,39772387,28954216,57396415,67957915,119304212,61865978,173723113,23480852,120438027,152921846,157615305,145950251,57076839,32634513,136478027,163492659,39244229,63685601,116014576,137649358,116182951,147254172,149589942,61267655,41007820,121181055,3783311,144747039,23931770,90818647,103371345,34352487,59775036,88290720,123798476,38696895,90179012,122049368,87405336,23412344,46175221,62498864,119285298,18127361,107826547,93276061,20858400,70910805,27027177,107455111,653933,90930873,30562156]
followers_lista = lista
print "Found %d followers of %s" % (len(followers_lista), SCREENNAME)
#print followers_json
#followers_json = followers_json['ids'] # get earliest followers first for batching
followers_lista.reverse()
print followers_lista 

# Groups a list in chunks of a given size
def group(lst, n):
    for i in range(0, len(lst), n):
        val = lst[i:i+n]
        if len(val) == n:
            yield tuple(val)

# Where to start? Overlap one batch to increase hit rate if people unfollow etc.
batchdone = scraperwiki.sqlite.get_var('batchdone', 1)
batchstart = batchdone - 1
if batchstart < 1:
    batchstart = 1

# Take 100 at a time, and do one lookup call for each batch
c = 0
for follower_list in group(followers_lista, 100):
#    print 'Thee batchmode loop in progress.'

    c = c + 1
    if c < batchstart:
        continue
    print "Processing batch number", c, "out of", len(followers_lista) / 100
#    print 'Batch of ids:', follower_list

    url = 'http://api.twitter.com/1/users/lookup.json?user_id=%s' % (urllib2.quote(','.join(map(str, follower_list))))
    print 'Getting url:', url
    details_json = simplejson.loads(scraperwiki.scrape(url))
    for detail in details_json:
        n = n + 1
        data = {'screen_name': detail['screen_name'],
                'id': detail['id'],
                'location': detail['location'], 
                'name': detail['name'], 
                'bio': detail['description'], 
                'created_at': detail['created_at'], 
                'followers_count': detail['followers_count'], 
                'friends_count': detail['friends_count'], 
                'statuses_count': detail['statuses_count'], 
                'listed_count': detail['listed_count'], 
                'url': detail['url'], 
                'time_zone': detail['time_zone']}
        print "Person:", n
        scraperwiki.sqlite.save(unique_keys=['id'], data = data)
    scraperwiki.sqlite.save_var('batchdone', c)
rate_url = 'https://api.twitter.com/1/account/rate_limit_status.json'
rate_json = simplejson.loads(scraperwiki.scrape(rate_url))
print rate_json
print 'You have %s hits left of 150. Reload time will be at - %s -' % (rate_json['remaining_hits'], rate_json['reset_time']) 
c = 0
print "Persons processed:", n
n = 0
import scraperwiki
import simplejson
import urllib2
import sys

SCREENNAME = 'mikapirhonen' #  - just for reminding, no actual use
c = 0
n = 0
#{'reset_time': 'Thu Apr 05 22:13:14 +0000 2012', 'remaining_hits': 0, 'hourly_limit': 150, 'reset_time_in_seconds': 1333663994}
resetrate_url = 'https://api.twitter.com/1/account/rate_limit_status.json'
resetrate_json = simplejson.loads(scraperwiki.scrape(resetrate_url))
print resetrate_json
print 'You have %s hits left of 150. Reload time is at - %s -' % (resetrate_json['remaining_hits'], resetrate_json['reset_time']) 

#PUT HERE a list of follower's id
lista = [25065931,131575586,425662368,221501401,48277956,15487001,163480463,20932375,37483735,19342892,21243219,363055355,326765877,84652506,537222739,532892366,27621959,281487951,168597350,21026596,122384941,81633482,18599476,420516748,224943395,25066495,49330305,524732380,408730137,426442687,23739307,79843502,139974630,120802940,423426629,133185594,493208206,461201574,113762357,263811916,441617223,70636551,180742547,435857424,289767245,496338193,486743563,16986635,184743515,516316452,113348784,157241090,182549347,376112744,45317597,240207367,120760003,456124705,218443293,124139637,421382180,29689455,29426045,107508796,424564514,330237340,144318792,281954561,19120153,388740093,60562610,59076504,259654794,481981578,173115724,26040028,390854986,276618851,336111790,496998068,86523664,398659891,218105502,308329921,401527517,425686194,365495604,240150593,220933156,261359918,400660558,120207925,51748261,237416112,97161136,428575452,94123963,34611019,85568401,286255386,287056919,329503437,487798637,471377191,182565585,80074783,293667475,29803296,24140765,1424431,72925064,27417458,325032908,482814731,110604718,379853627,315221301,58663928,7928622,405807314,15351845,58435819,97257153,47237865,30625540,96594983,208484103,28311607,260874209,23744470,423354428,484115525,43360175,18607750,293535414,192423199,37959657,431702899,331132813,19337766,25268744,110759549,421226464,472810111,154047671,176430467,420022758,467368925,267072171,427286515,459054224,287256859,75255662,394208419,97670081,408743967,347423381,453784237,31103526,247277350,22629024,465398448,325058309,17243913,474360877,463608539,68227505,435773068,426469307,209073357,403342277,33844169,26830676,425843876,114723763,138526129,30931835,198826114,18606767,368199853,396811941,188627191,75234234,19308529,64203453,15521350,252547221,114690195,38816542,24964422,28077489,317080762,407812095,407304219,357076509,65971046,467376419,18533828,408271246,276911574,93936160,446602113,455561279,159958848,49013625,22737511,425661002,425657741,350300539,45548817,17564168,462286167,456358111,321231837,339542222,64830462,41651717,110493104,430016780,407959551,20324973,423488493,218836548,55960182,85537158,258409768,29657011,52447702,88876150,363637875,267760307,340258228,41330145,350015005,412579026,54954594,167778423,449026442,426550264,68410168,26292218,436214107,16706344,440979078,261180763,431078930,157749525,158716395,91318134,453682179,10029732,311681011,47342599,325968661,252729237,376327472,228668350,399564723,17939970,350463809,280898348,211841899,156895489,439460810,447672298,273221987,329931629,20624036,18212957,423474106,248307923,22470277,243278144,295739079,157928648,30482231,197119145,440742217,148500864,432414670,216282763,284730339,362310309,440993589,440870916,176384260,59136010,303631084,146584055,47276003,439384594,132432232,114190724,82563845,40219683,152161092,49589863,302509288,200428611,121997851,436969356,130305298,31673599,298347334,14755988,420570111,430980922,285492043,374034494,430224820,62261202,428091343,352750214,41332997,429792190,224671891,224250614,432362570,128404685,424244751,434241693,223941213,26732407,407611967,18472399,157000503,305219173,423695516,323261080,262771060,6602952,20761934,374430433,198445040,18132670,258462627,21187644,417246923,23480205,317457842,216448822,38429072,39259963,317618006,287801111,28757338,15775978,36353978,74975464,83398258,223409880,17963191,141682676,21550734,271097408,131944579,146658224,412240008,104818833,224622999,46905923,18132451,92938502,101457482,44945145,118981106,416497051,397835956,336083411,139496374,288153222,110483876,108580489,57161847,232665310,240884208,276842487,371138243,29492570,112978241,350484026,22797686,92703365,418811972,53677389,31634823,418820131,55927258,59247745,55534033,41890489,109205108,194928965,284562212,300716312,107159745,413330288,271845217,274094762,18393491,48084843,124339443,411502604,93862231,20624395,7555782,304804330,12323552,49304190,247303258,14656057,406820800,285876522,15114927,21194582,390016434,304415968,260836502,281986476,256589433,405202786,395873179,240819202,265028142,392711115,9585582,403901199,277556628,398783797,313598500,71880308,361790266,26102521,261791261,392711359,396485461,83568421,15468299,18881541,351464360,188436540,63666966,387855078,12323042,270466536,17948250,169421250,5863392,234478164,339429511,275065933,318821105,375752277,263058638,114684567,49057872,384224000,42069029,269805356,181638177,23745760,18932935,86270150,29629039,20507517,67266336,316404112,93829849,349513956,379044249,79584032,257014593,14367725,12550682,48336950,161650067,359851773,352339762,29527862,46331041,133235131,282421113,367180328,115180114,370029655,65590627,370269606,43335085,156951821,372031377,139014812,133407635,35427955,367963870,44361491,87162030,11503752,292838330,221333493,102984435,253714448,133698522,18266486,233836410,189056270,364749198,28768946,78859905,14801580,44632485,57635408,362465522,165006495,200004094,165843097,189498819,354780292,28754034,27904043,240216406,7200752,351856844,348337806,247850994,116869717,298621654,41762177,333949163,352210312,17211426,51697333,28536525,85784333,347833945,17994895,42852229,344257156,261699922,328830752,226981222,252988450,58598143,262815123,260628355,74382201,340969961,340682815,232989293,83842212,337041176,333216172,5874122,132456693,336401100,68111414,19678124,320687857,16110222,14273044,155290328,20107082,325480428,319472262,312565532,116427510,269350667,118876667,329314824,48942140,32376263,302513800,19830008,326126042,16219247,28973665,324692750,221799635,29994938,310980350,101528153,89661107,251169763,61425181,12441132,278036867,319325224,258038452,76654856,302160239,18999759,151644613,29685832,244953643,95379713,310396757,239696089,13740602,64225071,108630742,22764476,308611237,280885082,310336691,262449821,56956655,58568152,77836871,201587011,19905986,70333896,18157856,153859877,23479608,251021119,208432888,15776240,256872986,56800316,34878643,17438664,295601460,242214721,300190968,63527074,28968310,149149335,42640298,114144050,36471278,208167487,15747938,59798715,50961013,146081868,56477964,266001904,62200145,124246972,160527484,201175944,143528756,264154489,256499438,41204815,216148108,274920641,8830042,146618989,284478086,97285523,224417952,285796003,176824061,84145738,114531905,32486235,283842667,283676779,214008845,245324743,280629713,21695613,96437165,270225338,210071354,173503289,248599523,281396967,280658520,8854792,279637781,55581844,107393662,777433,27451431,49249180,105915412,126586209,14266117,256076224,95407870,21684736,24869761,125601252,16061163,266026288,273873883,50744958,28782464,24033118,113048301,214250993,47389708,273902407,207546384,58818905,270784975,19497039,27206892,77981676,137089400,245698005,34725256,142977623,17661968,174786223,21787960,266525586,264795893,17621290,264141147,212531741,81897817,81818413,35724163,251823002,112816059,257569346,15656722,156272364,239157425,125016954,36027831,248716346,223453582,265823952,222245765,114996185,79270210,20503912,26711501,53465673,44172458,227285416,147518127,158984672,259209836,139351136,208703269,17063694,130684475,252462399,15926718,55316171,220672968,81142302,260193354,15011150,25048631,230402128,88641905,14281841,255457505,233997129,20622234,8440552,107722679,258244525,251685465,96950187,71257829,255674243,239078877,97292706,251101506,62620735,218955487,95642758,40037823,183658275,24669835,226262155,20389631,245752699,94168183,146423720,102010466,194457742,87314364,149046357,27194845,31892367,45953109,245718132,252987375,23499199,153860955,609663,10512712,188714490,190650259,73867482,237662413,160899313,31922164,245449737,63170099,85605620,195645364,15580384,92360037,181111597,18717138,15179791,112198413,215686339,12016992,203574543,218807369,26817718,34339205,139733501,214919581,245074292,46180560,134116716,242648184,107750908,49992313,23479304,87886476,49609985,33598269,26189216,190584751,57932466,23466089,60835835,117376525,102025211,111950574,111976700,95559675,59057158,50395453,156907738,39207660,14461551,45343200,37734064,97255235,90406034,225878736,14157810,89398664,105103109,178163572,2754521,149475166,229396232,25261244,9312552,169970131,39210238,28006501,64988419,14301783,17801749,21733540,99491210,120065660,140103585,39975027,69821056,71341838,14076980,135809363,209459812,40204167,91543055,17337554,216867363,72648886,22362222,52525439,18768419,212155281,26847675,207183055,19232478,101700887,38617356,61590821,70483539,217850013,23483819,16964609,221424326,212302569,55025892,210825049,221423704,18363508,202602407,65617605,93207353,42942682,41644465,102425654,19447383,182747581,216305509,20937910,71515593,23488524,118703531,35711196,120545919,74120119,116706058,46196044,89434823,111372034,157243343,206272796,41999248,14087632,12641112,195047638,96761126,18632646,201375516,202985553,68914379,88745281,24147717,42361971,126293147,51188048,197088514,111448029,60038174,14662163,192530788,39480276,27857108,39251308,8980752,127752505,109962895,80518687,184026629,14384133,17761008,43112148,86263348,58802669,108313540,83789727,21486642,118793791,72814867,108701268,98834390,79969468,34243490,128968441,22471974,23116687,34356968,18485019,18676836,82826646,15687977,42240022,19651554,17866320,13419352,19412403,23981582,39559231,12063202,88468420,39772387,28954216,57396415,67957915,119304212,61865978,173723113,23480852,120438027,152921846,157615305,145950251,57076839,32634513,136478027,163492659,39244229,63685601,116014576,137649358,116182951,147254172,149589942,61267655,41007820,121181055,3783311,144747039,23931770,90818647,103371345,34352487,59775036,88290720,123798476,38696895,90179012,122049368,87405336,23412344,46175221,62498864,119285298,18127361,107826547,93276061,20858400,70910805,27027177,107455111,653933,90930873,30562156]
followers_lista = lista
print "Found %d followers of %s" % (len(followers_lista), SCREENNAME)
#print followers_json
#followers_json = followers_json['ids'] # get earliest followers first for batching
followers_lista.reverse()
print followers_lista 

# Groups a list in chunks of a given size
def group(lst, n):
    for i in range(0, len(lst), n):
        val = lst[i:i+n]
        if len(val) == n:
            yield tuple(val)

# Where to start? Overlap one batch to increase hit rate if people unfollow etc.
batchdone = scraperwiki.sqlite.get_var('batchdone', 1)
batchstart = batchdone - 1
if batchstart < 1:
    batchstart = 1

# Take 100 at a time, and do one lookup call for each batch
c = 0
for follower_list in group(followers_lista, 100):
#    print 'Thee batchmode loop in progress.'

    c = c + 1
    if c < batchstart:
        continue
    print "Processing batch number", c, "out of", len(followers_lista) / 100
#    print 'Batch of ids:', follower_list

    url = 'http://api.twitter.com/1/users/lookup.json?user_id=%s' % (urllib2.quote(','.join(map(str, follower_list))))
    print 'Getting url:', url
    details_json = simplejson.loads(scraperwiki.scrape(url))
    for detail in details_json:
        n = n + 1
        data = {'screen_name': detail['screen_name'],
                'id': detail['id'],
                'location': detail['location'], 
                'name': detail['name'], 
                'bio': detail['description'], 
                'created_at': detail['created_at'], 
                'followers_count': detail['followers_count'], 
                'friends_count': detail['friends_count'], 
                'statuses_count': detail['statuses_count'], 
                'listed_count': detail['listed_count'], 
                'url': detail['url'], 
                'time_zone': detail['time_zone']}
        print "Person:", n
        scraperwiki.sqlite.save(unique_keys=['id'], data = data)
    scraperwiki.sqlite.save_var('batchdone', c)
rate_url = 'https://api.twitter.com/1/account/rate_limit_status.json'
rate_json = simplejson.loads(scraperwiki.scrape(rate_url))
print rate_json
print 'You have %s hits left of 150. Reload time will be at - %s -' % (rate_json['remaining_hits'], rate_json['reset_time']) 
c = 0
print "Persons processed:", n
n = 0
