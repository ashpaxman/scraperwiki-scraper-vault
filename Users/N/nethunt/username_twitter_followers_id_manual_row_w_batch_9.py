import scraperwiki
import simplejson
import urllib2
import sys

SCREENNAME = 'tommyrosenqvist' #  - just for reminding, no actual use
c = 0
n = 0
#{'reset_time': 'Thu Apr 05 22:13:14 +0000 2012', 'remaining_hits': 0, 'hourly_limit': 150, 'reset_time_in_seconds': 1333663994}
resetrate_url = 'https://api.twitter.com/1/account/rate_limit_status.json'
resetrate_json = simplejson.loads(scraperwiki.scrape(resetrate_url))
print resetrate_json
print 'You have %s hits left of 150. Reload time is at - %s -' % (resetrate_json['remaining_hits'], resetrate_json['reset_time']) 

#PUT HERE a list of follower's id
lista = [125286257,95250374,372407584,32564296,15487001,30185787,384506738,18159511,134269404,110633174,537222739,460866961,455561279,534713894,418649694,537293315,368199853,496731191,33844169,491246656,14266117,132172221,396811941,217359498,302836892,29697753,472432828,515602088,259347296,68400250,397101695,271823650,486797931,218567054,116269160,233646996,252605178,315664413,31173155,67641289,19704781,516316452,357076509,35491343,136629815,377936398,218188900,119719029,14273044,397901896,19345048,112259757,26040028,42387735,120802940,181573122,484650622,29242458,237475103,180742547,255457505,28311607,469457321,146618989,505710136,312658227,105103109,129479911,264332386,142627775,19546490,358271069,130305298,280101676,469301858,115040037,387855078,41554323,496118937,26739604,252729237,23945093,493224346,404716590,492484547,462787555,43860296,358645383,182856071,310980350,487798637,490292562,26592417,43723105,39210238,102609197,231427195,480292500,416620485,251169763,224943395,426074424,327312471,260836502,282421113,472250360,370006213,54674052,480448746,41330145,37430992,397986885,355374915,63527074,117366336,269469957,70099046,472810111,409423732,426465211,121997851,476801098,428575452,29685832,132249164,317618006,150629402,119139724,179047001,425657741,280504974,270225338,54954594,55927258,407812095,23768972,19283402,393218743,313536137,94123963,435773068,75234234,115385049,85537158,41126857,316404112,110759549,23596546,149835227,48084843,61750791,303631084,173115724,16181348,23479536,20624036,27417458,399564723,211841899,55641280,80074783,449026442,425661002,453973508,271097408,262815123,439936006,267768991,84145738,435235623,421226464,448906016,448759558,448880303,447672298,329931629,434241693,92252931,430980922,444767886,234267684,181094585,440870916,416459582,286034170,367963870,68410168,428091343,169507477,285492043,371138243,133407635,374430433,51423800,427286515,26269383,92072896,124339443,131944579,154898511,254244419,115770317,118981106,22797686,377434947,96437165,112978241,85784333,255018757,418820131,225929727,109205108,416497051,395873179,396485461,242214721,249579201,281372518,232146077,407324218,276911574,25048631,366001970,43890150,212893205,70654746,351464360,293458348,311681011,252505447,336111790,139014812,302513800,14359778,382097737,389437240,157928648,188714490,153366297,349513956,28536525,263058638,234485216,59798715,26073116,201650116,384361647,384346302,97255235,275900408,185821367,67266336,15456487,380458136,179684355,367180328,108038400,108677412,89398664,232665310,48460323,376624081,372721988,375012013,325968661,333321282,77981676,42852229,292164777,306765983,42069029,165006495,369626247,369182530,274094762,285507844,14970708,255616350,42586410,222245765,14301783,362310309,56769330,356706402,99166322,355439096,306315283,155290328,351022798,350484026,223409880,24506713,206075025,280629713,23474663,346442436,89408715,40037823,118613189,298621654,15724954,259209836,116427510,55960182,252988450,342595106,269350667,53465673,138467237,34878643,128504641,108630742,15979857,240819202,122010223,61425181,332932695,289377522,225878736,278970473,256589433,256872986,333949163,132456693,203574543,29629039,333465937,253205790,284730339,66924632,224671891,330949013,224250614,263586844,325480428,18212957,326126042,44945145,321231837,37665086,297955296,44950608,18768419,278036867,59820825,22764476,310336691,262609871,274920641,174772675,283044608,224622999,23925646,208432888,66634269,286586866,109225440,233943822,277556628,55316171,174990361,284478086,256076224,210926477,284182694,26817718,258946113,93687642,74098182,28782464,107393662,87162030,20503912,253260223,279637781,245813839,273844971,257496218,97044421,78859905,273873883,109915670,119315877,111545036,270784975,211613888,242684651,117659597,84853729,256030631,137089400,199372599,223441585,264678710,50961013,12441132,89434823,258271439,266498684,154841463,97292706,87929259,28804247,35427955,246390610,23483819,212093506,250249388,227285416,73867482,27421468,46331041,261359918,233997129,257664564,119392958,17152448,57473214,211195656,215686339,259654794,125016954,21289408,245324743,25330173,42220046,49651036,46905923,12323552,223295534,256462588,62620735,79731207,169462720,14483698,194457742,255840443,216090090,134199209,252462399,146423720,50276284,181880942,224843685,245698005,5721792,137072816,31922164,239257265,212592239,147518127,237242116,245074292,188436540,195645364,40833868,219666332,194649465,93207353,232088007,32376263,200923051,44172458,230948735,31892367,222432732,166332206,123685714,30625540,216867363,39207660,135809363,61865978,35337058,74423484,149046357,221424326,105218555,55025892,221423704,23479304,181469205,54662763,41644465,71341838,19232478,60835835,132902975,64369544,220281522,114459338,218955487,220672968,79270210,202602407,214003584,71515593,214919581,23466089,217850013,74424000,208167487,107425262,14582659,16282770,213844183,210825049,21902595,213474760,120065660,16831108,111372034,19447383,777433,176697571,9039452,205489306,24695719,202985553,25065931,164127330,20389631,117376525,122282528,34611019,194043404,107937983,79843502,84846560,140103585,176481820,190836544,24965231,127752505,190650259,40864535,190279477,104128509,74972770,37906284,189800730,101700887,71880308,18266486,45343200,36058189,9312552,41139189,102025211,185545819,23556764,169970131,111448029,184026629,72277900,20937044,21289183,61590821,28568590,128968441,19497039,71987304,53871469,138526129,19830008,170587283,110487452,19342892,148817980,157243343,176728613,56334759,112547566,30482231,103371345,148272010,57932466,88396321,174786223,15903134,91186555,118793791,17275233,16706344,16937546,92360037,172699288,75989970,7200752,43112148,139548644,28092121,80518687,157615305,36654919,160527484,22034529,156218519,51188048,163492659,40009651,19417603,145241926,42173442,99960174,39101281,20440795,136213106,47562616,125462292,50395453,39186548,51364279,145917949,15945776,126049180,153743338,123845385,57563669,154171235,24421137,139733501,112816059,87886476,35711196,108313540,101463046,148357427,149475166,153844517,15423353,88745281,22362222,146333500,152921846,28954216,123958756,146081868,149077935,151197475,609663,37483735,109271889,65401241,40204167,37467012,118703531,49609985,122578520,126275822,137984240,72334040,30210107,130749371,95464125,125772419,116706058,14312344,126927712,23485871,61267655,29943657,22457629,23116687,98834390,119671096,108701268,134166587,3799971,13762142,72814867,119304212,13419352,120391348,137649358,44392815,136279986,23479870,93936160,19371384,130187721,94283039,126327277,122325600,71239427,88641905,14281841,20622234,123722945,55581844,125752251,121181055,72842818,64993677,67957915,61304961,94856925,25487576,88468420,86263348,108580489,38696895,18133649,113048301,74413484,125550259,76246319,88290720,27860448,11633492,24023227,28768946,56690354,22668369,122935825,59529947,12401232,25037519,46326717,58597451,40205082,39975027,38955237,38227644,92500414,82947338,75255662,15218646,7928622,72817955,23479061,125299983,116453499,69223177,72648886,120451407,70154962,34725256,17761008,39559231,24033118,10276302,33855993,93829849,38368524,91543055,15126895,112422401,122049368,70066217,120438027,18632646,79969468,23561729,16110222,76878457,20541233,69841112,14087632,14302295,68914379,58224024,121197997,8980752,22463239,24508835,24140765,18157856,85777080,49564100,121035618,36471278,738333,66631557,65134133,14115881,110412936,36586930,32870801,39251308,18174991,20937910,44592312,50744958,114008595,119285298,72566916,90818647,119006065,5911062,95045265,102802398,97285523,108914074,39948168,27451431,63170099,39767357,26081532,42240022,22702612,112703168,22123860,21684673,23488524,99538881,37156625,29246858,110670265,40273385,47139770,22471974,20624395,21490414,102425654,12550682,61483631,96570785,43091683,74083887,112975092,101516264,9792232,103597692,108001357,26847675,80847655,34267476,81897817,39480276,39772387,29514021,29994938,111416249,20590105,107806522,96160555,80860818,60840373,56956655,42942682,110944111,18632187,41207295,14099563,50736378,102177084,108693169,70896696,31488254,83158619,87405336,96162115,88926963,25261244,110493104,108550514,20107082,12063202,106689325,90179012,102010466,27093184,57396415,86073794,70757049,27460190,96523939,14755988,55647421,33598269,105856707,40873228,108881260,29657011,34352487,38424544,18676836,16286195,86914223,23931770,23617109,23981582,105571009,42361971,100786705,14384133,11305432,32634513,60445947,81818413,63949733,19701607,14076980,19678124,19905986,89947889,19412403,85122824,97661004,38470845,17211426,7511792,93754215,14073512,69891359,20299685,18132670,18122635,17994895,22186443,23589713,88878000,18932374,83579046,25261523,24147717,93592240,92412536,91297651,23502747,91849328,86347445,84126638,20761934,87314364,49698621,75908898,34621907,30944220,15105428,19817595,41999248,21703561,79115249,27826761,6202072,44547906,36693209,70910805,14461551,18548604,81142302,34233905,34243490,34339205,5863392,17866320,20858400,15687977,17639250,19226961,23480852,65590627,18721677,14157810,26559595,27017978,77361000,14367725,46196044,27264899,29028473,52525439,21486642,46867828,15217838,49570027,74117012,51975596,16392849,23482778,73361766,39540130,15884908,60038174,3783311,24159369,41765501,55706325,76337894,17892760,17157969,62498864,21090961,10356762,1356261,23655494,18256775,46609842,40244792,17305642,27027177,18538599,25721374,8453452,66956664,21385954,25468658,20907812,36731103,21329567,51023960,49973534,21318791,7502342,27868217,22262225,23413450,22360764,31392803,44321678,22158434,14996563,38674353,32382004,43853351,20359688,18670386,18973638]
followers_lista = lista
print "Found %d followers of %s" % (len(followers_lista), SCREENNAME)
#print followers_json
#followers_json = followers_json['ids'] # get earliest followers first for batching
followers_lista.reverse()
print followers_lista 

# Groups a list in chunks of a given size
def group(lst, n):
    for i in range(0, len(lst), n):
        val = lst[i:i+n]
        if len(val) == n:
            yield tuple(val)

# Where to start? Overlap one batch to increase hit rate if people unfollow etc.
batchdone = scraperwiki.sqlite.get_var('batchdone', 1)
batchstart = batchdone - 1
if batchstart < 1:
    batchstart = 1

# Take 100 at a time, and do one lookup call for each batch
c = 0
for follower_list in group(followers_lista, 100):
#    print 'Thee batchmode loop in progress.'

    c = c + 1
    if c < batchstart:
        continue
    print "Processing batch number", c, "out of", len(followers_lista) / 100
#    print 'Batch of ids:', follower_list

    url = 'http://api.twitter.com/1/users/lookup.json?user_id=%s' % (urllib2.quote(','.join(map(str, follower_list))))
    print 'Getting url:', url
    details_json = simplejson.loads(scraperwiki.scrape(url))
    for detail in details_json:
        n = n + 1
        data = {'screen_name': detail['screen_name'],
                'id': detail['id'],
                'location': detail['location'], 
                'name': detail['name'], 
                'bio': detail['description'], 
                'created_at': detail['created_at'], 
                'followers_count': detail['followers_count'], 
                'friends_count': detail['friends_count'], 
                'statuses_count': detail['statuses_count'], 
                'listed_count': detail['listed_count'], 
                'url': detail['url'], 
                'time_zone': detail['time_zone']}
        print "Person:", n
        scraperwiki.sqlite.save(unique_keys=['id'], data = data)
    scraperwiki.sqlite.save_var('batchdone', c)
rate_url = 'https://api.twitter.com/1/account/rate_limit_status.json'
rate_json = simplejson.loads(scraperwiki.scrape(rate_url))
print rate_json
print 'You have %s hits left of 150. Reload time will be at - %s -' % (rate_json['remaining_hits'], rate_json['reset_time']) 
c = 0
print "Persons processed:", n
n = 0
import scraperwiki
import simplejson
import urllib2
import sys

SCREENNAME = 'tommyrosenqvist' #  - just for reminding, no actual use
c = 0
n = 0
#{'reset_time': 'Thu Apr 05 22:13:14 +0000 2012', 'remaining_hits': 0, 'hourly_limit': 150, 'reset_time_in_seconds': 1333663994}
resetrate_url = 'https://api.twitter.com/1/account/rate_limit_status.json'
resetrate_json = simplejson.loads(scraperwiki.scrape(resetrate_url))
print resetrate_json
print 'You have %s hits left of 150. Reload time is at - %s -' % (resetrate_json['remaining_hits'], resetrate_json['reset_time']) 

#PUT HERE a list of follower's id
lista = [125286257,95250374,372407584,32564296,15487001,30185787,384506738,18159511,134269404,110633174,537222739,460866961,455561279,534713894,418649694,537293315,368199853,496731191,33844169,491246656,14266117,132172221,396811941,217359498,302836892,29697753,472432828,515602088,259347296,68400250,397101695,271823650,486797931,218567054,116269160,233646996,252605178,315664413,31173155,67641289,19704781,516316452,357076509,35491343,136629815,377936398,218188900,119719029,14273044,397901896,19345048,112259757,26040028,42387735,120802940,181573122,484650622,29242458,237475103,180742547,255457505,28311607,469457321,146618989,505710136,312658227,105103109,129479911,264332386,142627775,19546490,358271069,130305298,280101676,469301858,115040037,387855078,41554323,496118937,26739604,252729237,23945093,493224346,404716590,492484547,462787555,43860296,358645383,182856071,310980350,487798637,490292562,26592417,43723105,39210238,102609197,231427195,480292500,416620485,251169763,224943395,426074424,327312471,260836502,282421113,472250360,370006213,54674052,480448746,41330145,37430992,397986885,355374915,63527074,117366336,269469957,70099046,472810111,409423732,426465211,121997851,476801098,428575452,29685832,132249164,317618006,150629402,119139724,179047001,425657741,280504974,270225338,54954594,55927258,407812095,23768972,19283402,393218743,313536137,94123963,435773068,75234234,115385049,85537158,41126857,316404112,110759549,23596546,149835227,48084843,61750791,303631084,173115724,16181348,23479536,20624036,27417458,399564723,211841899,55641280,80074783,449026442,425661002,453973508,271097408,262815123,439936006,267768991,84145738,435235623,421226464,448906016,448759558,448880303,447672298,329931629,434241693,92252931,430980922,444767886,234267684,181094585,440870916,416459582,286034170,367963870,68410168,428091343,169507477,285492043,371138243,133407635,374430433,51423800,427286515,26269383,92072896,124339443,131944579,154898511,254244419,115770317,118981106,22797686,377434947,96437165,112978241,85784333,255018757,418820131,225929727,109205108,416497051,395873179,396485461,242214721,249579201,281372518,232146077,407324218,276911574,25048631,366001970,43890150,212893205,70654746,351464360,293458348,311681011,252505447,336111790,139014812,302513800,14359778,382097737,389437240,157928648,188714490,153366297,349513956,28536525,263058638,234485216,59798715,26073116,201650116,384361647,384346302,97255235,275900408,185821367,67266336,15456487,380458136,179684355,367180328,108038400,108677412,89398664,232665310,48460323,376624081,372721988,375012013,325968661,333321282,77981676,42852229,292164777,306765983,42069029,165006495,369626247,369182530,274094762,285507844,14970708,255616350,42586410,222245765,14301783,362310309,56769330,356706402,99166322,355439096,306315283,155290328,351022798,350484026,223409880,24506713,206075025,280629713,23474663,346442436,89408715,40037823,118613189,298621654,15724954,259209836,116427510,55960182,252988450,342595106,269350667,53465673,138467237,34878643,128504641,108630742,15979857,240819202,122010223,61425181,332932695,289377522,225878736,278970473,256589433,256872986,333949163,132456693,203574543,29629039,333465937,253205790,284730339,66924632,224671891,330949013,224250614,263586844,325480428,18212957,326126042,44945145,321231837,37665086,297955296,44950608,18768419,278036867,59820825,22764476,310336691,262609871,274920641,174772675,283044608,224622999,23925646,208432888,66634269,286586866,109225440,233943822,277556628,55316171,174990361,284478086,256076224,210926477,284182694,26817718,258946113,93687642,74098182,28782464,107393662,87162030,20503912,253260223,279637781,245813839,273844971,257496218,97044421,78859905,273873883,109915670,119315877,111545036,270784975,211613888,242684651,117659597,84853729,256030631,137089400,199372599,223441585,264678710,50961013,12441132,89434823,258271439,266498684,154841463,97292706,87929259,28804247,35427955,246390610,23483819,212093506,250249388,227285416,73867482,27421468,46331041,261359918,233997129,257664564,119392958,17152448,57473214,211195656,215686339,259654794,125016954,21289408,245324743,25330173,42220046,49651036,46905923,12323552,223295534,256462588,62620735,79731207,169462720,14483698,194457742,255840443,216090090,134199209,252462399,146423720,50276284,181880942,224843685,245698005,5721792,137072816,31922164,239257265,212592239,147518127,237242116,245074292,188436540,195645364,40833868,219666332,194649465,93207353,232088007,32376263,200923051,44172458,230948735,31892367,222432732,166332206,123685714,30625540,216867363,39207660,135809363,61865978,35337058,74423484,149046357,221424326,105218555,55025892,221423704,23479304,181469205,54662763,41644465,71341838,19232478,60835835,132902975,64369544,220281522,114459338,218955487,220672968,79270210,202602407,214003584,71515593,214919581,23466089,217850013,74424000,208167487,107425262,14582659,16282770,213844183,210825049,21902595,213474760,120065660,16831108,111372034,19447383,777433,176697571,9039452,205489306,24695719,202985553,25065931,164127330,20389631,117376525,122282528,34611019,194043404,107937983,79843502,84846560,140103585,176481820,190836544,24965231,127752505,190650259,40864535,190279477,104128509,74972770,37906284,189800730,101700887,71880308,18266486,45343200,36058189,9312552,41139189,102025211,185545819,23556764,169970131,111448029,184026629,72277900,20937044,21289183,61590821,28568590,128968441,19497039,71987304,53871469,138526129,19830008,170587283,110487452,19342892,148817980,157243343,176728613,56334759,112547566,30482231,103371345,148272010,57932466,88396321,174786223,15903134,91186555,118793791,17275233,16706344,16937546,92360037,172699288,75989970,7200752,43112148,139548644,28092121,80518687,157615305,36654919,160527484,22034529,156218519,51188048,163492659,40009651,19417603,145241926,42173442,99960174,39101281,20440795,136213106,47562616,125462292,50395453,39186548,51364279,145917949,15945776,126049180,153743338,123845385,57563669,154171235,24421137,139733501,112816059,87886476,35711196,108313540,101463046,148357427,149475166,153844517,15423353,88745281,22362222,146333500,152921846,28954216,123958756,146081868,149077935,151197475,609663,37483735,109271889,65401241,40204167,37467012,118703531,49609985,122578520,126275822,137984240,72334040,30210107,130749371,95464125,125772419,116706058,14312344,126927712,23485871,61267655,29943657,22457629,23116687,98834390,119671096,108701268,134166587,3799971,13762142,72814867,119304212,13419352,120391348,137649358,44392815,136279986,23479870,93936160,19371384,130187721,94283039,126327277,122325600,71239427,88641905,14281841,20622234,123722945,55581844,125752251,121181055,72842818,64993677,67957915,61304961,94856925,25487576,88468420,86263348,108580489,38696895,18133649,113048301,74413484,125550259,76246319,88290720,27860448,11633492,24023227,28768946,56690354,22668369,122935825,59529947,12401232,25037519,46326717,58597451,40205082,39975027,38955237,38227644,92500414,82947338,75255662,15218646,7928622,72817955,23479061,125299983,116453499,69223177,72648886,120451407,70154962,34725256,17761008,39559231,24033118,10276302,33855993,93829849,38368524,91543055,15126895,112422401,122049368,70066217,120438027,18632646,79969468,23561729,16110222,76878457,20541233,69841112,14087632,14302295,68914379,58224024,121197997,8980752,22463239,24508835,24140765,18157856,85777080,49564100,121035618,36471278,738333,66631557,65134133,14115881,110412936,36586930,32870801,39251308,18174991,20937910,44592312,50744958,114008595,119285298,72566916,90818647,119006065,5911062,95045265,102802398,97285523,108914074,39948168,27451431,63170099,39767357,26081532,42240022,22702612,112703168,22123860,21684673,23488524,99538881,37156625,29246858,110670265,40273385,47139770,22471974,20624395,21490414,102425654,12550682,61483631,96570785,43091683,74083887,112975092,101516264,9792232,103597692,108001357,26847675,80847655,34267476,81897817,39480276,39772387,29514021,29994938,111416249,20590105,107806522,96160555,80860818,60840373,56956655,42942682,110944111,18632187,41207295,14099563,50736378,102177084,108693169,70896696,31488254,83158619,87405336,96162115,88926963,25261244,110493104,108550514,20107082,12063202,106689325,90179012,102010466,27093184,57396415,86073794,70757049,27460190,96523939,14755988,55647421,33598269,105856707,40873228,108881260,29657011,34352487,38424544,18676836,16286195,86914223,23931770,23617109,23981582,105571009,42361971,100786705,14384133,11305432,32634513,60445947,81818413,63949733,19701607,14076980,19678124,19905986,89947889,19412403,85122824,97661004,38470845,17211426,7511792,93754215,14073512,69891359,20299685,18132670,18122635,17994895,22186443,23589713,88878000,18932374,83579046,25261523,24147717,93592240,92412536,91297651,23502747,91849328,86347445,84126638,20761934,87314364,49698621,75908898,34621907,30944220,15105428,19817595,41999248,21703561,79115249,27826761,6202072,44547906,36693209,70910805,14461551,18548604,81142302,34233905,34243490,34339205,5863392,17866320,20858400,15687977,17639250,19226961,23480852,65590627,18721677,14157810,26559595,27017978,77361000,14367725,46196044,27264899,29028473,52525439,21486642,46867828,15217838,49570027,74117012,51975596,16392849,23482778,73361766,39540130,15884908,60038174,3783311,24159369,41765501,55706325,76337894,17892760,17157969,62498864,21090961,10356762,1356261,23655494,18256775,46609842,40244792,17305642,27027177,18538599,25721374,8453452,66956664,21385954,25468658,20907812,36731103,21329567,51023960,49973534,21318791,7502342,27868217,22262225,23413450,22360764,31392803,44321678,22158434,14996563,38674353,32382004,43853351,20359688,18670386,18973638]
followers_lista = lista
print "Found %d followers of %s" % (len(followers_lista), SCREENNAME)
#print followers_json
#followers_json = followers_json['ids'] # get earliest followers first for batching
followers_lista.reverse()
print followers_lista 

# Groups a list in chunks of a given size
def group(lst, n):
    for i in range(0, len(lst), n):
        val = lst[i:i+n]
        if len(val) == n:
            yield tuple(val)

# Where to start? Overlap one batch to increase hit rate if people unfollow etc.
batchdone = scraperwiki.sqlite.get_var('batchdone', 1)
batchstart = batchdone - 1
if batchstart < 1:
    batchstart = 1

# Take 100 at a time, and do one lookup call for each batch
c = 0
for follower_list in group(followers_lista, 100):
#    print 'Thee batchmode loop in progress.'

    c = c + 1
    if c < batchstart:
        continue
    print "Processing batch number", c, "out of", len(followers_lista) / 100
#    print 'Batch of ids:', follower_list

    url = 'http://api.twitter.com/1/users/lookup.json?user_id=%s' % (urllib2.quote(','.join(map(str, follower_list))))
    print 'Getting url:', url
    details_json = simplejson.loads(scraperwiki.scrape(url))
    for detail in details_json:
        n = n + 1
        data = {'screen_name': detail['screen_name'],
                'id': detail['id'],
                'location': detail['location'], 
                'name': detail['name'], 
                'bio': detail['description'], 
                'created_at': detail['created_at'], 
                'followers_count': detail['followers_count'], 
                'friends_count': detail['friends_count'], 
                'statuses_count': detail['statuses_count'], 
                'listed_count': detail['listed_count'], 
                'url': detail['url'], 
                'time_zone': detail['time_zone']}
        print "Person:", n
        scraperwiki.sqlite.save(unique_keys=['id'], data = data)
    scraperwiki.sqlite.save_var('batchdone', c)
rate_url = 'https://api.twitter.com/1/account/rate_limit_status.json'
rate_json = simplejson.loads(scraperwiki.scrape(rate_url))
print rate_json
print 'You have %s hits left of 150. Reload time will be at - %s -' % (rate_json['remaining_hits'], rate_json['reset_time']) 
c = 0
print "Persons processed:", n
n = 0
