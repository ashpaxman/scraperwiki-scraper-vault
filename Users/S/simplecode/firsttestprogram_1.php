<?php

# Blank PHP
       
require 'scraperwiki/simple_html_dom.php';
$dom = new simple_html_dom();


    $array = array('8126854','8225536','8095513','8136833','8225512','8095512','8173631','8152097','8225510','8189206','8185607','8196039','8169733','8156975','8169729','8200234','8227800','8056899','8126482','8172708','8197920','8174629','8209987','8127872','8202744','8181520','8169731','2859520','8156849','8199517','8157164','8157392','8159125','8167038','8136807','8165635','8172779','8118518','8027524','8127563','8172705','8127359','8168550','8053250','8057313','8155631','8159943','8226640','8056700','8194065','8172707','8173018','8207363','8130012','8189223','8191570','8208027','8130032','8127792','8165768','8169356','8200356','8216556','8169730','8207914','8227321','8233615','8222891','8021768','8125319','8169378','8179276','8018574','1033967','201206','8090168','8171844','8207907','8134797','8199925','8202746','8207387','8017150','8047834','8187315','8198544','8207362','1726857','8126007','8188573','8131673','8176538','8189612','8191250','8028935','8160569','8168871','8170848','8136534');
 
//array('8202746','8201380','8202984','8030251','8191060','6557273','8150037','8219158','8058421','8202782','8186760','6166673','8133054','8162251','8127827','8139045','8174618','8153713','8200998','8217199','1042311D','1432411','1432446','8009080','8172708','8203372','5593946','8172769','6357916','8178115','8071204','8096498','8181212','1041986','5993847','8016867','8124345','8184388','8201682','5253118','6344326','8115806','8189952','8201009','8202777','8019129','8097443','8199900','8200474','8009076','8015924','8155638','607870','8009074','8125943','8167568','8191562','3590','8162173','8198536','8209987','8211911','8214895','8073994','8139700','8174633','8197110','8207400','8158437','8172112','8178086','8180178','8119339','8160951','8167186','8016478','8166930','8207402','8208178','261','720719','8083033','8127565','8166945','8202744','8003720','8138440','8205259','8157523','8158305','8199898','8200200','8122672','8138350','8158436','8181755','8200373','8176273','8182933','8188771','8208932','8216719','8212968B','8095515','8194350','8199905','8200478','8002996','8042521','8127656','8157771','8164096','8168298','8187315','8216182','5946016','8198544','8208423','8211075','8043614','8110644','8150548','8169382','8134112','8213934','8009072','8156645','4451963','8139747','8198645','8199281','768274','8072803','8089610','8099273','8165765','8225510','1042052','1050459','5634421','8040221','8125239','8153647','8175450','8183408','8207392','857380','1951648','8178088','8200172');

    echo date('H:i:s T').PHP_EOL;
    //test



$ch = curl_init();
curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 30);
curl_setopt($ch, CURLOPT_USERAGENT, "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)");
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
//curl_setopt($ch, CURLOPT_COOKIEJAR, COOKIEJAR);
//curl_setopt($ch, CURLOPT_COOKIEFILE, COOKIEJAR);
curl_setopt($ch, CURLOPT_HEADER, 0);  
curl_setopt($ch, CURLOPT_RETURNTRANSFER,1);
curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 120);
curl_setopt($ch, CURLOPT_TIMEOUT, 120);




        $opts = array(
            'http'=>array(
                'method'=>"GET",
                'header'=>"Accept-language: en\r\n" .
                "User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)\r\n".
                "Cookie: foo=bar\r\n"
            )
        );
        
        
        
        $context = stream_context_create($opts);

    foreach ($array as $value) {

        //echo '---1----';
    
        //$html = scraperWiki::scrape('http://www.playgroundonline.com/affiliates.aspx?src_id=decathlon&itemcode='.$value);           

        $html = file_get_html('http://www.playgroundonline.com/affiliates.aspx?src_id=decathlon&itemcode='.$value, false, $context);

        //echo '----2----';
        //print_r($html->plaintext);
        //echo '----2a-----';
        $e = $html->find('#ctl00_ContentPlaceHolder1_hfFinalPrice');

        if (!isset($e[0]))
        {
            //echo 'Is not set'.PHP_EOL;
            $data = ";".$value."\t".";".PHP_EOL;

            $record = array(
                'model' => $value,
                'offer price' => '');
    
            scraperwiki::save(array('model'), $record);  
        }
        else
        {
            //echo 'is set'.PHP_EOL;
        
            $pgo_price = $e[0]->value;
            
            $data = ";".$value."\t".$pgo_price.";".PHP_EOL;
    
            $record = array(
                'model' => $value,
                'offer price' => $pgo_price);
    
            scraperwiki::save(array('model'), $record);  
        }

        //echo $data;

        //free memory used by
        //unset($html);

        //file_put_contents($path, $data, FILE_APPEND);


    }
    echo 'end = '.date('H:i:s T').PHP_EOL;



?><?php

# Blank PHP
       
require 'scraperwiki/simple_html_dom.php';
$dom = new simple_html_dom();


    $array = array('8126854','8225536','8095513','8136833','8225512','8095512','8173631','8152097','8225510','8189206','8185607','8196039','8169733','8156975','8169729','8200234','8227800','8056899','8126482','8172708','8197920','8174629','8209987','8127872','8202744','8181520','8169731','2859520','8156849','8199517','8157164','8157392','8159125','8167038','8136807','8165635','8172779','8118518','8027524','8127563','8172705','8127359','8168550','8053250','8057313','8155631','8159943','8226640','8056700','8194065','8172707','8173018','8207363','8130012','8189223','8191570','8208027','8130032','8127792','8165768','8169356','8200356','8216556','8169730','8207914','8227321','8233615','8222891','8021768','8125319','8169378','8179276','8018574','1033967','201206','8090168','8171844','8207907','8134797','8199925','8202746','8207387','8017150','8047834','8187315','8198544','8207362','1726857','8126007','8188573','8131673','8176538','8189612','8191250','8028935','8160569','8168871','8170848','8136534');
 
//array('8202746','8201380','8202984','8030251','8191060','6557273','8150037','8219158','8058421','8202782','8186760','6166673','8133054','8162251','8127827','8139045','8174618','8153713','8200998','8217199','1042311D','1432411','1432446','8009080','8172708','8203372','5593946','8172769','6357916','8178115','8071204','8096498','8181212','1041986','5993847','8016867','8124345','8184388','8201682','5253118','6344326','8115806','8189952','8201009','8202777','8019129','8097443','8199900','8200474','8009076','8015924','8155638','607870','8009074','8125943','8167568','8191562','3590','8162173','8198536','8209987','8211911','8214895','8073994','8139700','8174633','8197110','8207400','8158437','8172112','8178086','8180178','8119339','8160951','8167186','8016478','8166930','8207402','8208178','261','720719','8083033','8127565','8166945','8202744','8003720','8138440','8205259','8157523','8158305','8199898','8200200','8122672','8138350','8158436','8181755','8200373','8176273','8182933','8188771','8208932','8216719','8212968B','8095515','8194350','8199905','8200478','8002996','8042521','8127656','8157771','8164096','8168298','8187315','8216182','5946016','8198544','8208423','8211075','8043614','8110644','8150548','8169382','8134112','8213934','8009072','8156645','4451963','8139747','8198645','8199281','768274','8072803','8089610','8099273','8165765','8225510','1042052','1050459','5634421','8040221','8125239','8153647','8175450','8183408','8207392','857380','1951648','8178088','8200172');

    echo date('H:i:s T').PHP_EOL;
    //test



$ch = curl_init();
curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 30);
curl_setopt($ch, CURLOPT_USERAGENT, "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)");
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
//curl_setopt($ch, CURLOPT_COOKIEJAR, COOKIEJAR);
//curl_setopt($ch, CURLOPT_COOKIEFILE, COOKIEJAR);
curl_setopt($ch, CURLOPT_HEADER, 0);  
curl_setopt($ch, CURLOPT_RETURNTRANSFER,1);
curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 120);
curl_setopt($ch, CURLOPT_TIMEOUT, 120);




        $opts = array(
            'http'=>array(
                'method'=>"GET",
                'header'=>"Accept-language: en\r\n" .
                "User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)\r\n".
                "Cookie: foo=bar\r\n"
            )
        );
        
        
        
        $context = stream_context_create($opts);

    foreach ($array as $value) {

        //echo '---1----';
    
        //$html = scraperWiki::scrape('http://www.playgroundonline.com/affiliates.aspx?src_id=decathlon&itemcode='.$value);           

        $html = file_get_html('http://www.playgroundonline.com/affiliates.aspx?src_id=decathlon&itemcode='.$value, false, $context);

        //echo '----2----';
        //print_r($html->plaintext);
        //echo '----2a-----';
        $e = $html->find('#ctl00_ContentPlaceHolder1_hfFinalPrice');

        if (!isset($e[0]))
        {
            //echo 'Is not set'.PHP_EOL;
            $data = ";".$value."\t".";".PHP_EOL;

            $record = array(
                'model' => $value,
                'offer price' => '');
    
            scraperwiki::save(array('model'), $record);  
        }
        else
        {
            //echo 'is set'.PHP_EOL;
        
            $pgo_price = $e[0]->value;
            
            $data = ";".$value."\t".$pgo_price.";".PHP_EOL;
    
            $record = array(
                'model' => $value,
                'offer price' => $pgo_price);
    
            scraperwiki::save(array('model'), $record);  
        }

        //echo $data;

        //free memory used by
        //unset($html);

        //file_put_contents($path, $data, FILE_APPEND);


    }
    echo 'end = '.date('H:i:s T').PHP_EOL;



?>