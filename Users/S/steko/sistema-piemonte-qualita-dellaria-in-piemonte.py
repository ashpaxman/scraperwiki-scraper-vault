import scraperwiki
import lxml.html
import urllib
import datetime


# reference start = "http://www.sistemapiemonte.it/ambiente/srqa/consultadati.shtml"
# but it's not needed to go through the forms

#

def extract_data(loc_code, startdate, param):
    '''Run the scraper for a single location and year'''
    rete, istat, progr = loc_code.split('_')
    print rete, istat, progr, startdate
    numGiorni = 33 # max accepted value
    params = {
        'rete_000':rete,
        'istat_000':istat,
        'progr_000':progr,
        'aggr_000':'0',
        'dataInizio': '%d/%d/%d'%(startdate.day, startdate.month, startdate.year),
        'numGiorni':numGiorni,
        'param_000':param,
        'filtroUscita':'/xsrqaStationParamTableFilter.jsp',
        'recordCompleti':'no'
    }

    url = 'http://www.sistemapiemonte.it/ambiente/srqa/consultadati_ora.shtml?%s' % urllib.urlencode(params)
    html = urllib.urlopen(url).read()
    root = lxml.html.fromstring(html)
    table = root.cssselect("table.grande")[0]

    # take apart the table
    rows = table.cssselect("tr")
    assert rows[0][0].text == 'data / ora', lxml.html.tostring(table)
    hours = [ int(th.text)  for th in rows[0][1:] ]
    assert hours == range(1, 25), lxml.html.tostring(rows[0])

    alldata = [ ]
    for row in rows[1:]:
        tdate = datetime.datetime.strptime(row[0].text, "%d/%m/%Y")

        for hour, col in zip(hours, row[1:]):
            data = { "loc_code":loc_code, "param":param }
            data["datetime"] = datetime.datetime(tdate.year, tdate.month, tdate.day, hour-1)   # note: hour shifted by 1 because it can't be 24
            try:
                data["value"] = float(col.text)
                alldata.append(data)
            except ValueError:
                print "bad value in row", lxml.html.tostring(row)
    scraperwiki.sqlite.save(unique_keys=["datetime", "loc_code", "param"], data=alldata)


def loop_params(location):
    loc_code = location['location']
    for param in location['params']:
        loop_date(loc_code,param)

def loop_date(loc_code,param):
    ahead = True
    tdelta = datetime.timedelta(days=33)
    st_date = datetime.date.today() - tdelta
    while ahead is True:
        ahead = extract_data(loc_code,st_date,param)
        st_date = st_date - tdelta

def Main():
    for l in locations:
        loop_params(l)





# static dictionaries of pollution and stations
# 
# might be better to create them dynamically from the JS source

polluters = {
    'BENZENE': 'Benzene',
    '04': 'Biossido di azoto (NO2)',
    '01': 'Biossido di zolfo (SO2)',
    '21': 'Monossido di azoto (NO)',
    '02': 'Monossido di carbonio (CO)',
    '05': 'Ozono (O3)',
    '03': 'Partic. totali sospese',
    'PM10_GBV': 'Polveri PM10 - Basso Volume',
    'PM10_B': 'Polveri PM10 - Beta',
    'AS': 'Arsenico (PM10)',
    'M3_034': 'Benzo(a)pirene (PM10)',
    'CADMIO': 'Cadmio (PM10)',
    'PIOMBO': 'Piombo (PM10)',
    'PM2.5': 'Polveri PM2.5 - Basso Volume',
    'PM10_N': 'Polveri PM10 - Nefelometro',
    'PM10_T': 'Polveri PM10 - Teom',
    'POL_PM10': 'Polveri PM10 - Generiche',
    'PM2.5_TF': 'Polveri PM2.5 - Teom FDMS',
    'PM2.5_B': 'Polveri PM2.5 - Beta',
    }


locations = [{'location': '13_001078_801', 'params': ['04', '21']},
 {'location': '11_006003_805',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM2.5']},
 {'location': '11_006003_806', 'params': ['04', '01', '21', 'PM10_B']},
 {'location': '11_006160_800',
  'params': ['AS', 'M3_034', '01', 'CADMIO', 'PIOMBO', 'PM10_GBV']},
 {'location': '11_006003_801',
  'params': ['AS',
             'BENZENE',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '02',
             'PIOMBO',
             'PM10_GBV']},
 {'location': '15_999999_805',
  'params': ['AS',
             'BENZENE',
             'M3_034',
             '04',
             '01',
             'CADMIO',
             '21',
             '02',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM10_T']},
 {'location': '13_001272_822',
  'params': ['AS',
             'BENZENE',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '02',
             'PIOMBO',
             'PM10_GBV']},
 {'location': '15_002158_803',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM2.5']},
 {'location': '16_003024_801', 'params': ['04', '21', '02', 'PM10_B']},
 {'location': '13_001028_801',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM2.5']},
 {'location': '16_003043_800', 'params': ['04', '01', '21', '05']},
 {'location': '13_999998_804', 'params': ['BENZENE', '04', '02']},
 {'location': '50_005005_801',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM10_B',
             'PM2.5']},
 {'location': '50_005005_802',
  'params': ['BENZENE', '04', '01', '21', '02', 'PM10_GBV']},
 {'location': '13_999999_808',
  'params': ['AS',
             'BENZENE',
             'M3_034',
             '04',
             '01',
             'CADMIO',
             '21',
             '02',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM10_N']},
 {'location': '22_004003_800',
  'params': ['AS',
             'BENZENE',
             'M3_034',
             '04',
             '01',
             'CADMIO',
             '21',
             '02',
             '05',
             'PIOMBO',
             'PM10_GBV']},
 {'location': '16_003061_800', 'params': ['04', '21']},
 {'location': '13_001073_800',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM10_B',
             'PM2.5']},
 {'location': '22_004029_801',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '02',
             'PIOMBO',
             'PM10_GBV']},
 {'location': '13_001272_803',
  'params': ['AS',
             'BENZENE',
             'M3_034',
             '04',
             '01',
             'CADMIO',
             '21',
             '02',
             '03',
             'PIOMBO',
             'PM10_GBV']},
 {'location': '13_001171_801', 'params': ['04', '21', '05']},
 {'location': '16_003010_800',
  'params': ['AS', 'M3_034', 'CADMIO', '05', 'PIOMBO', 'PM10_GBV', 'PM2.5']},
 {'location': '11_006066_800',
  'params': ['AS',
             'M3_034',
             '04',
             '01',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM2.5']},
 {'location': '13_001086_800', 'params': ['04', '01', '21']},
 {'location': '69_001130_800',
  'params': ['04', '21', '02', '05', 'PM10_B', 'PM2.5_B']},
 {'location': '22_004078_800',
  'params': ['AS',
             'BENZENE',
             'M3_034',
             '04',
             '01',
             'CADMIO',
             '21',
             '02',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM10_B',
             'PM2.5']},
 {'location': '13_001099_800',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV']},
 {'location': '13_001120_801', 'params': ['04', '01', '21']},
 {'location': '13_001309_801', 'params': ['04', '21', '05']},
 {'location': '13_001191_801',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV']},
 {'location': '22_004089_800', 'params': ['04', '21']},
 {'location': '13_001059_801',
  'params': ['AS', 'M3_034', 'CADMIO', 'PIOMBO', 'PM10_GAV', 'PM10_GBV']},
 {'location': '64_002159_800', 'params': ['04', '21', '05', 'PM10_T']},
 {'location': '50_999999_807',
  'params': ['AS',
             'BENZENE',
             'M3_034',
             '04',
             '01',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV']},
 {'location': '64_002012_802',
  'params': ['AS',
             'BENZENE',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '02',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM10_T',
             'PM2.5']},
 {'location': '64_002012_803',
  'params': ['AS',
             'BENZENE',
             'M3_034',
             '04',
             '01',
             'CADMIO',
             '21',
             '02',
             'PIOMBO',
             'PM10_GBV']},
 {'location': '13_001272_806',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM10_B',
             'PM2.5']},
 {'location': '16_003049_800',
  'params': ['AS',
             'BENZENE',
             'M3_034',
             '04',
             '01',
             'CADMIO',
             '21',
             'PIOMBO',
             'PM10_GBV',
             'PM2.5_TF']},
 {'location': '13_001008_801', 'params': ['04', '21', '05']},
 {'location': '11_006039_801', 'params': ['BENZENE', '04', '21', 'PM10_N']},
 {'location': '11_006174_800',
  'params': ['AS', 'M3_034', '04', 'CADMIO', '21', 'PIOMBO', 'PM10_GBV']},
 {'location': '16_003156_801',
  'params': ['AS',
             'BENZENE',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '02',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM10_B',
             'PM2.5']},
 {'location': '13_001024_801', 'params': ['04', '21']},
 {'location': '69_001018_800', 'params': ['04', '21', '02', '05', 'PM10_B']},
 {'location': '15_002158_800', 'params': ['BENZENE', '04', '21', '02']},
 {'location': '16_999999_801',
  'params': ['AS',
             'BENZENE',
             'M3_034',
             '04',
             '01',
             'CADMIO',
             '21',
             '02',
             '05',
             '03',
             'PIOMBO',
             'PM10_GBV']},
 {'location': '16_003110_800', 'params': ['04', '21', '02']},
 {'location': '16_003108_800', 'params': ['04', '21', '02', 'PM10_B']},
 {'location': '13_001265_802', 'params': ['04', '21', '02']},
 {'location': '22_004201_800',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM2.5']},
 {'location': '64_002046_800',
  'params': ['AS',
             'BENZENE',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '02',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM10_T']},
 {'location': '16_003118_800', 'params': ['BENZENE', '04', '01', '21', '05']},
 {'location': '16_003008_800', 'params': ['04', '21', '05']},
 {'location': '11_006001_801', 'params': ['04', '21', '05', 'PM10_B']},
 {'location': '13_001125_802',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM2.5']},
 {'location': '16_003149_800',
  'params': ['BENZENE', '04', '01', '21', 'PM2.5_TF']},
 {'location': '15_002016_800',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM2.5']},
 {'location': '64_002149_800', 'params': ['04', '21', '05', 'PM2.5']},
 {'location': '65_001082_802',
  'params': ['04', '01', '21', '05', 'PM10_B', 'PM2.5_B']},
 {'location': '16_003106_803',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM10_B',
             'PM2.5']},
 {'location': '16_003106_801', 'params': ['04', '01', '21']},
 {'location': '11_006114_801', 'params': ['04', '01', '21', '02']},
 {'location': '16_003106_804',
  'params': ['AS',
             'BENZENE',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '02',
             'PIOMBO',
             'PM10_GBV']},
 {'location': '22_999999_803',
  'params': ['BENZENE',
             '04',
             '01',
             '21',
             '02',
             '05',
             'PM10_GBV',
             'POL_PM10',
             'PM10_N']},
 {'location': '13_001272_819',
  'params': ['AS', 'M3_034', 'CADMIO', 'PIOMBO', 'PM10_GAV', 'PM10_GBV']},
 {'location': '16_003018_800', 'params': ['04', '21', '05']},
 {'location': '13_001272_805', 'params': ['04', '01', '21', '02']},
 {'location': '11_999999_802',
  'params': ['BENZENE',
             '04',
             '01',
             '21',
             '02',
             '05',
             '03',
             'PM10_GBV',
             'PM10_B']},
 {'location': '13_001175_800', 'params': ['04', '21', '02', 'PM10_B']},
 {'location': '50_005120_800',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM2.5']},
 {'location': '13_001272_812',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV']},
 {'location': '65_001064_802',
  'params': ['04', '01', '21', '05', 'PM10_B', 'PM2.5_B']},
 {'location': '22_004025_800',
  'params': ['AS',
             'M3_034',
             '04',
             '01',
             'CADMIO',
             '21',
             'PIOMBO',
             'PM10_GBV']},
 {'location': '13_001270_801',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV']}]

Main()
import scraperwiki
import lxml.html
import urllib
import datetime


# reference start = "http://www.sistemapiemonte.it/ambiente/srqa/consultadati.shtml"
# but it's not needed to go through the forms

#

def extract_data(loc_code, startdate, param):
    '''Run the scraper for a single location and year'''
    rete, istat, progr = loc_code.split('_')
    print rete, istat, progr, startdate
    numGiorni = 33 # max accepted value
    params = {
        'rete_000':rete,
        'istat_000':istat,
        'progr_000':progr,
        'aggr_000':'0',
        'dataInizio': '%d/%d/%d'%(startdate.day, startdate.month, startdate.year),
        'numGiorni':numGiorni,
        'param_000':param,
        'filtroUscita':'/xsrqaStationParamTableFilter.jsp',
        'recordCompleti':'no'
    }

    url = 'http://www.sistemapiemonte.it/ambiente/srqa/consultadati_ora.shtml?%s' % urllib.urlencode(params)
    html = urllib.urlopen(url).read()
    root = lxml.html.fromstring(html)
    table = root.cssselect("table.grande")[0]

    # take apart the table
    rows = table.cssselect("tr")
    assert rows[0][0].text == 'data / ora', lxml.html.tostring(table)
    hours = [ int(th.text)  for th in rows[0][1:] ]
    assert hours == range(1, 25), lxml.html.tostring(rows[0])

    alldata = [ ]
    for row in rows[1:]:
        tdate = datetime.datetime.strptime(row[0].text, "%d/%m/%Y")

        for hour, col in zip(hours, row[1:]):
            data = { "loc_code":loc_code, "param":param }
            data["datetime"] = datetime.datetime(tdate.year, tdate.month, tdate.day, hour-1)   # note: hour shifted by 1 because it can't be 24
            try:
                data["value"] = float(col.text)
                alldata.append(data)
            except ValueError:
                print "bad value in row", lxml.html.tostring(row)
    scraperwiki.sqlite.save(unique_keys=["datetime", "loc_code", "param"], data=alldata)


def loop_params(location):
    loc_code = location['location']
    for param in location['params']:
        loop_date(loc_code,param)

def loop_date(loc_code,param):
    ahead = True
    tdelta = datetime.timedelta(days=33)
    st_date = datetime.date.today() - tdelta
    while ahead is True:
        ahead = extract_data(loc_code,st_date,param)
        st_date = st_date - tdelta

def Main():
    for l in locations:
        loop_params(l)





# static dictionaries of pollution and stations
# 
# might be better to create them dynamically from the JS source

polluters = {
    'BENZENE': 'Benzene',
    '04': 'Biossido di azoto (NO2)',
    '01': 'Biossido di zolfo (SO2)',
    '21': 'Monossido di azoto (NO)',
    '02': 'Monossido di carbonio (CO)',
    '05': 'Ozono (O3)',
    '03': 'Partic. totali sospese',
    'PM10_GBV': 'Polveri PM10 - Basso Volume',
    'PM10_B': 'Polveri PM10 - Beta',
    'AS': 'Arsenico (PM10)',
    'M3_034': 'Benzo(a)pirene (PM10)',
    'CADMIO': 'Cadmio (PM10)',
    'PIOMBO': 'Piombo (PM10)',
    'PM2.5': 'Polveri PM2.5 - Basso Volume',
    'PM10_N': 'Polveri PM10 - Nefelometro',
    'PM10_T': 'Polveri PM10 - Teom',
    'POL_PM10': 'Polveri PM10 - Generiche',
    'PM2.5_TF': 'Polveri PM2.5 - Teom FDMS',
    'PM2.5_B': 'Polveri PM2.5 - Beta',
    }


locations = [{'location': '13_001078_801', 'params': ['04', '21']},
 {'location': '11_006003_805',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM2.5']},
 {'location': '11_006003_806', 'params': ['04', '01', '21', 'PM10_B']},
 {'location': '11_006160_800',
  'params': ['AS', 'M3_034', '01', 'CADMIO', 'PIOMBO', 'PM10_GBV']},
 {'location': '11_006003_801',
  'params': ['AS',
             'BENZENE',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '02',
             'PIOMBO',
             'PM10_GBV']},
 {'location': '15_999999_805',
  'params': ['AS',
             'BENZENE',
             'M3_034',
             '04',
             '01',
             'CADMIO',
             '21',
             '02',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM10_T']},
 {'location': '13_001272_822',
  'params': ['AS',
             'BENZENE',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '02',
             'PIOMBO',
             'PM10_GBV']},
 {'location': '15_002158_803',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM2.5']},
 {'location': '16_003024_801', 'params': ['04', '21', '02', 'PM10_B']},
 {'location': '13_001028_801',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM2.5']},
 {'location': '16_003043_800', 'params': ['04', '01', '21', '05']},
 {'location': '13_999998_804', 'params': ['BENZENE', '04', '02']},
 {'location': '50_005005_801',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM10_B',
             'PM2.5']},
 {'location': '50_005005_802',
  'params': ['BENZENE', '04', '01', '21', '02', 'PM10_GBV']},
 {'location': '13_999999_808',
  'params': ['AS',
             'BENZENE',
             'M3_034',
             '04',
             '01',
             'CADMIO',
             '21',
             '02',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM10_N']},
 {'location': '22_004003_800',
  'params': ['AS',
             'BENZENE',
             'M3_034',
             '04',
             '01',
             'CADMIO',
             '21',
             '02',
             '05',
             'PIOMBO',
             'PM10_GBV']},
 {'location': '16_003061_800', 'params': ['04', '21']},
 {'location': '13_001073_800',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM10_B',
             'PM2.5']},
 {'location': '22_004029_801',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '02',
             'PIOMBO',
             'PM10_GBV']},
 {'location': '13_001272_803',
  'params': ['AS',
             'BENZENE',
             'M3_034',
             '04',
             '01',
             'CADMIO',
             '21',
             '02',
             '03',
             'PIOMBO',
             'PM10_GBV']},
 {'location': '13_001171_801', 'params': ['04', '21', '05']},
 {'location': '16_003010_800',
  'params': ['AS', 'M3_034', 'CADMIO', '05', 'PIOMBO', 'PM10_GBV', 'PM2.5']},
 {'location': '11_006066_800',
  'params': ['AS',
             'M3_034',
             '04',
             '01',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM2.5']},
 {'location': '13_001086_800', 'params': ['04', '01', '21']},
 {'location': '69_001130_800',
  'params': ['04', '21', '02', '05', 'PM10_B', 'PM2.5_B']},
 {'location': '22_004078_800',
  'params': ['AS',
             'BENZENE',
             'M3_034',
             '04',
             '01',
             'CADMIO',
             '21',
             '02',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM10_B',
             'PM2.5']},
 {'location': '13_001099_800',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV']},
 {'location': '13_001120_801', 'params': ['04', '01', '21']},
 {'location': '13_001309_801', 'params': ['04', '21', '05']},
 {'location': '13_001191_801',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV']},
 {'location': '22_004089_800', 'params': ['04', '21']},
 {'location': '13_001059_801',
  'params': ['AS', 'M3_034', 'CADMIO', 'PIOMBO', 'PM10_GAV', 'PM10_GBV']},
 {'location': '64_002159_800', 'params': ['04', '21', '05', 'PM10_T']},
 {'location': '50_999999_807',
  'params': ['AS',
             'BENZENE',
             'M3_034',
             '04',
             '01',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV']},
 {'location': '64_002012_802',
  'params': ['AS',
             'BENZENE',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '02',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM10_T',
             'PM2.5']},
 {'location': '64_002012_803',
  'params': ['AS',
             'BENZENE',
             'M3_034',
             '04',
             '01',
             'CADMIO',
             '21',
             '02',
             'PIOMBO',
             'PM10_GBV']},
 {'location': '13_001272_806',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM10_B',
             'PM2.5']},
 {'location': '16_003049_800',
  'params': ['AS',
             'BENZENE',
             'M3_034',
             '04',
             '01',
             'CADMIO',
             '21',
             'PIOMBO',
             'PM10_GBV',
             'PM2.5_TF']},
 {'location': '13_001008_801', 'params': ['04', '21', '05']},
 {'location': '11_006039_801', 'params': ['BENZENE', '04', '21', 'PM10_N']},
 {'location': '11_006174_800',
  'params': ['AS', 'M3_034', '04', 'CADMIO', '21', 'PIOMBO', 'PM10_GBV']},
 {'location': '16_003156_801',
  'params': ['AS',
             'BENZENE',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '02',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM10_B',
             'PM2.5']},
 {'location': '13_001024_801', 'params': ['04', '21']},
 {'location': '69_001018_800', 'params': ['04', '21', '02', '05', 'PM10_B']},
 {'location': '15_002158_800', 'params': ['BENZENE', '04', '21', '02']},
 {'location': '16_999999_801',
  'params': ['AS',
             'BENZENE',
             'M3_034',
             '04',
             '01',
             'CADMIO',
             '21',
             '02',
             '05',
             '03',
             'PIOMBO',
             'PM10_GBV']},
 {'location': '16_003110_800', 'params': ['04', '21', '02']},
 {'location': '16_003108_800', 'params': ['04', '21', '02', 'PM10_B']},
 {'location': '13_001265_802', 'params': ['04', '21', '02']},
 {'location': '22_004201_800',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM2.5']},
 {'location': '64_002046_800',
  'params': ['AS',
             'BENZENE',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '02',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM10_T']},
 {'location': '16_003118_800', 'params': ['BENZENE', '04', '01', '21', '05']},
 {'location': '16_003008_800', 'params': ['04', '21', '05']},
 {'location': '11_006001_801', 'params': ['04', '21', '05', 'PM10_B']},
 {'location': '13_001125_802',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM2.5']},
 {'location': '16_003149_800',
  'params': ['BENZENE', '04', '01', '21', 'PM2.5_TF']},
 {'location': '15_002016_800',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM2.5']},
 {'location': '64_002149_800', 'params': ['04', '21', '05', 'PM2.5']},
 {'location': '65_001082_802',
  'params': ['04', '01', '21', '05', 'PM10_B', 'PM2.5_B']},
 {'location': '16_003106_803',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM10_B',
             'PM2.5']},
 {'location': '16_003106_801', 'params': ['04', '01', '21']},
 {'location': '11_006114_801', 'params': ['04', '01', '21', '02']},
 {'location': '16_003106_804',
  'params': ['AS',
             'BENZENE',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '02',
             'PIOMBO',
             'PM10_GBV']},
 {'location': '22_999999_803',
  'params': ['BENZENE',
             '04',
             '01',
             '21',
             '02',
             '05',
             'PM10_GBV',
             'POL_PM10',
             'PM10_N']},
 {'location': '13_001272_819',
  'params': ['AS', 'M3_034', 'CADMIO', 'PIOMBO', 'PM10_GAV', 'PM10_GBV']},
 {'location': '16_003018_800', 'params': ['04', '21', '05']},
 {'location': '13_001272_805', 'params': ['04', '01', '21', '02']},
 {'location': '11_999999_802',
  'params': ['BENZENE',
             '04',
             '01',
             '21',
             '02',
             '05',
             '03',
             'PM10_GBV',
             'PM10_B']},
 {'location': '13_001175_800', 'params': ['04', '21', '02', 'PM10_B']},
 {'location': '50_005120_800',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV',
             'PM2.5']},
 {'location': '13_001272_812',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV']},
 {'location': '65_001064_802',
  'params': ['04', '01', '21', '05', 'PM10_B', 'PM2.5_B']},
 {'location': '22_004025_800',
  'params': ['AS',
             'M3_034',
             '04',
             '01',
             'CADMIO',
             '21',
             'PIOMBO',
             'PM10_GBV']},
 {'location': '13_001270_801',
  'params': ['AS',
             'M3_034',
             '04',
             'CADMIO',
             '21',
             '05',
             'PIOMBO',
             'PM10_GBV']}]

Main()
