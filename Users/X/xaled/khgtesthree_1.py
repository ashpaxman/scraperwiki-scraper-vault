import scraperwiki
import re


# Blank Python






regex1='<p\\s+class="sectionheader">\\s+(\\d+)\\s+:\\s+(.*?)<span.*?>'
regex2='CVSSv2\\s+Base\\s+Score\\s+=\\s+(\\d+(?:\\.\\d+))'

array = [3092,3093,3233,578,3268,12184,877,5098,473,630,5099,5646,397,17670,721,637,2695,3931,474,28260,5647,3380,27071,6695,4598,3396,3299,2946,17111,6672,3762,48,596,3501,4171,6196,50553,2117,9238,13404,436,21366,9392,6666,539,524,5407,9624,5523,670,18114,279,4192,13402,13403,4806,294,10944,3384,59619,376,55370,4314,6698,32333,240,789,651,2511,2243,5102,534,1264,13431,12606,2562,3591,4013,5106,8204,4908,4161,2717,4910,6226,2873,6659,3295,396,3514,4015,562,3515,3568,701,113,6662,5092,105,15971,4301,38019,14329,19772,561,21365,1210,25497,5692,700,3954,32774,3483,11740,5095,3489,11741,5096,12607,11871,4969,7715,4907,1201,4663,3296,8193,27095,236,2820,54589,237,613,136,20234,128,31694,155,3284,9231,724,4265,2733,3624,9715,41361,2878,7022,728,5097,27487,2017,10107,53413,4261,20232,319,2767,27097,5034,5103,2689,5104,568,5709,2322,25499,5105,6661,25498,59093,56,3382,2411,6466,59620,5292,19947,2193,379,59618,4297,2703,53303,2813,2790,2225,7505,2842,17671,55369,7504,50539,5498,7503,20235,3280,7495,2735,3289,543,7498,5914,3294,13978,677,7499,7497,9256,6192,7496,3417,1909,5107,2876,50552,53304,142,3632,17657,5374,17665,34878,6699,3633,42680,3126,17666,12721,6181,134,847,9216,3720,4262,35707,13405,9217,50619,3500,52975,272,6694,67,4266,4360,41850,4361,27096,39272,4765,4398,11093,5049,6467,9239,2,53386,2944,17659,50551,9332,2948,62684,17661,4599,4571,3,17662,4804,38580,10447,17660,37511,54034,6656,10598,3512,54099,13981,29786,4854,4,5178,6560,11145,2088,35876,7501,11144,59031,28,228,2921,682,3282,127,2950,6670,2722,6671,8103,17653,3201,2915,17654,694,17655,17113,9257,17652,5803,3458,6591,2754,5108,5689,3486,17656,551,4619,34879]



rg1 = re.compile(regex1,re.IGNORECASE|re.DOTALL)
rg2 = re.compile(regex2,re.IGNORECASE|re.DOTALL)

for a in array:
    html = scraperwiki.scrape("http://osvdb.org/" + str(a))
    m1 = rg1.search(html)
    m2 = rg2.search(html)
    if m1 and m2:
        
        data = {
            'ID' : m1.group(1),
            'descr' : m1.group(2),
            'score' : m2.group(1),
            'table_name' : 'osvbd'}
        scraperwiki.sqlite.save(unique_keys=['ID'], data=data)
import scraperwiki
import re


# Blank Python






regex1='<p\\s+class="sectionheader">\\s+(\\d+)\\s+:\\s+(.*?)<span.*?>'
regex2='CVSSv2\\s+Base\\s+Score\\s+=\\s+(\\d+(?:\\.\\d+))'

array = [3092,3093,3233,578,3268,12184,877,5098,473,630,5099,5646,397,17670,721,637,2695,3931,474,28260,5647,3380,27071,6695,4598,3396,3299,2946,17111,6672,3762,48,596,3501,4171,6196,50553,2117,9238,13404,436,21366,9392,6666,539,524,5407,9624,5523,670,18114,279,4192,13402,13403,4806,294,10944,3384,59619,376,55370,4314,6698,32333,240,789,651,2511,2243,5102,534,1264,13431,12606,2562,3591,4013,5106,8204,4908,4161,2717,4910,6226,2873,6659,3295,396,3514,4015,562,3515,3568,701,113,6662,5092,105,15971,4301,38019,14329,19772,561,21365,1210,25497,5692,700,3954,32774,3483,11740,5095,3489,11741,5096,12607,11871,4969,7715,4907,1201,4663,3296,8193,27095,236,2820,54589,237,613,136,20234,128,31694,155,3284,9231,724,4265,2733,3624,9715,41361,2878,7022,728,5097,27487,2017,10107,53413,4261,20232,319,2767,27097,5034,5103,2689,5104,568,5709,2322,25499,5105,6661,25498,59093,56,3382,2411,6466,59620,5292,19947,2193,379,59618,4297,2703,53303,2813,2790,2225,7505,2842,17671,55369,7504,50539,5498,7503,20235,3280,7495,2735,3289,543,7498,5914,3294,13978,677,7499,7497,9256,6192,7496,3417,1909,5107,2876,50552,53304,142,3632,17657,5374,17665,34878,6699,3633,42680,3126,17666,12721,6181,134,847,9216,3720,4262,35707,13405,9217,50619,3500,52975,272,6694,67,4266,4360,41850,4361,27096,39272,4765,4398,11093,5049,6467,9239,2,53386,2944,17659,50551,9332,2948,62684,17661,4599,4571,3,17662,4804,38580,10447,17660,37511,54034,6656,10598,3512,54099,13981,29786,4854,4,5178,6560,11145,2088,35876,7501,11144,59031,28,228,2921,682,3282,127,2950,6670,2722,6671,8103,17653,3201,2915,17654,694,17655,17113,9257,17652,5803,3458,6591,2754,5108,5689,3486,17656,551,4619,34879]



rg1 = re.compile(regex1,re.IGNORECASE|re.DOTALL)
rg2 = re.compile(regex2,re.IGNORECASE|re.DOTALL)

for a in array:
    html = scraperwiki.scrape("http://osvdb.org/" + str(a))
    m1 = rg1.search(html)
    m2 = rg2.search(html)
    if m1 and m2:
        
        data = {
            'ID' : m1.group(1),
            'descr' : m1.group(2),
            'score' : m2.group(1),
            'table_name' : 'osvbd'}
        scraperwiki.sqlite.save(unique_keys=['ID'], data=data)
